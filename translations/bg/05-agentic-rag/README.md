[![Agentic RAG](../../../translated_images/bg/lesson-5-thumbnail.20ba9d0c0ae64fae.webp)](https://youtu.be/WcjAARvdL7I?si=BCgwjwFb2yCkEhR9)

> _(Кликнете върху изображението по-горе, за да гледате видео на този урок)_

# Agentic RAG

Този урок предоставя изчерпателен преглед на Agentic Retrieval-Augmented Generation (Agentic RAG), възникваща парадигма в ИИ, при която големи езикови модели (LLM) автономно планират следващите си стъпки, докато извличат информация от външни източници. За разлика от статичните модели за извличане-и-след-това-прочитане, Agentic RAG включва итеративни повиквания към LLM, редуващи се с повиквания на инструменти или функции и структурирани изходи. Системата оценява резултатите, усъвършенства заявките, използва допълнителни инструменти при нужда и продължава този цикъл, докато постигне удовлетворително решение.

## Въведение

Този урок ще обхване

- **Разбиране на Agentic RAG:** Научете за възникващата парадигма в ИИ, при която големи езикови модели (LLM) автономно планират следващите си стъпки, докато изтеглят информация от външни източници на данни.
- **Осмисляне на итеративния стил Maker-Checker:** Разберете цикъла на итеративни повиквания към LLM, редуващи се с повиквания на инструменти или функции и структурирани изходи, предназначени за подобряване на коректността и обработка на неправилно форматирани заявки.
- **Изследване на практически приложения:** Идентифицирайте сценарии, в които Agentic RAG се отличава, като среди с приоритет върху коректността, сложни взаимодействия с бази данни и разширени работни потоци.

## Цели на обучението

След завършване на този урок ще знаете как да/ще разбирате:

- **Разбиране на Agentic RAG:** Научете за възникващата парадигма в ИИ, при която големи езикови модели (LLM) автономно планират следващите си стъпки, докато изтеглят информация от външни източници на данни.
- **Итеративен стил Maker-Checker:** Осмислете концепцията за цикъл на итеративни повиквания към LLM, редуващи се с повиквания на инструменти или функции и структурирани изходи, предназначени да подобрят коректността и да се справят с неправилно форматирани заявки.
- **Контрол на процеса на разсъждение:** Разберете способността на системата да поема отговорност за процеса на разсъждение, като взема решения как да подхожда към проблемите без да разчита на предварително дефинирани пътища.
- **Работен процес:** Разберете как агентски модел независимо решава да извлече доклади за пазарни тенденции, идентифицира данни за конкуренти, свърже вътрешни показатели за продажби, синтезира откритията и оценява стратегията.
- **Итеративни цикли, интеграция на инструменти и памет:** Научете за зависимостта на системата от модел на циклично взаимодействие, поддържайки състояние и памет през стъпките, за да избегне повтарящи се цикли и да взема информирани решения.
- **Обработка на етапи на неуспех и само-корекция:** Изследвайте устойчивите механизми за само-корекция на системата, включително итерация и повторно заявяване, използване на диагностични инструменти и прибягване до човешки надзор.
- **Граници на агентността:** Разберете ограниченията на Agentic RAG, съсредоточени върху автономия, специфична за домейна, зависимост от инфраструктура и уважение към защитни механизми.
- **Практически случаи на употреба и стойност:** Идентифицирайте сценарии, в които Agentic RAG се откроява, като среди с приоритет върху коректността, сложни взаимодействия с бази данни и разширени работни потоци.
- **Управление, прозрачност и доверие:** Научете за важността на управлението и прозрачността, включително обяснимо разсъждение, контрол на пристрастия и човешки надзор.

## Какво е Agentic RAG?

Agentic Retrieval-Augmented Generation (Agentic RAG) е възникваща парадигма в ИИ, при която големи езикови модели (LLM) автономно планират следващите си стъпки, докато извличат информация от външни източници. За разлика от статичните модели за извличане-и-след-това-прочитане, Agentic RAG включва итеративни повиквания към LLM, редуващи се с повиквания на инструменти или функции и структурирани изходи. Системата оценява резултатите, усъвършенства заявките, използва допълнителни инструменти при нужда и продължава този цикъл, докато постигне удовлетворително решение. Този итеративен стил „maker-checker“ подобрява коректността, обработва неправилно форматирани заявки и осигурява висококачествени резултати.

Системата активно поема отговорност за процеса си на разсъждение, пренаписвайки неуспешни заявки, избирайки различни методи за извличане и интегрирайки множество инструменти — като търсене по вектори в Azure AI Search, SQL бази данни или потребителски API—преди да финализира своя отговор. Отличителната черта на агентската система е способността ѝ да поема отговорност за процеса на разсъждение. Традиционните реализации на RAG разчитат на предварително дефинирани пътища, но агентската система автономно определя последователността от стъпки въз основа на качеството на намерената информация.

## Дефиниране на Agentic Retrieval-Augmented Generation (Agentic RAG)

Agentic Retrieval-Augmented Generation (Agentic RAG) е възникваща парадигма в развитието на ИИ, при която LLM не само извличат информация от външни източници на данни, но и автономно планират следващите си стъпки. За разлика от статичните модели извличане-и-след-това-прочитане или внимателно скриптирани последователности на подканите, Agentic RAG включва цикъл от итеративни повиквания към LLM, редуващи се с повиквания на инструменти или функции и структурирани изходи. При всяка стъпка системата оценява получените резултати, решава дали да усъвършенства заявките си, активира допълнителни инструменти при нужда и продължава този цикъл, докато постигне удовлетворително решение.

Този итеративен стил на работа „maker-checker“ е предназначен да подобри коректността, да обработва неправилно форматирани заявки към структурирани бази данни (например NL2SQL) и да осигури балансирани, висококачествени резултати. Вместо да разчита само на внимателно разработени вериги от подканващи съобщения, системата активно поема контрола върху процеса на разсъждение. Тя може да пренаписва провалили се заявки, да избира различни методи за извличане и да интегрира множество инструменти — като търсене по вектори в Azure AI Search, SQL бази данни или потребителски API — преди да финализира своя отговор. Това премахва необходимостта от прекалено сложни рамки за оркестрация. Вместо това, относително прост цикъл „LLM повикване → използване на инструмент → LLM повикване → …“ може да доведе до сложни и добре обосновани изходи.

![Agentic RAG Core Loop](../../../translated_images/bg/agentic-rag-core-loop.c8f4b85c26920f71.webp)

## Поемане на процеса на разсъждение

Отличителната черта, която прави системата „агентска“, е нейната способност да поема контрола върху процеса на разсъждение. Традиционните реализации на RAG често разчитат на предварително дефиниран от човека път за модела: верига от мисли, която очертава какво да се извлече и кога.
Но когато системата е наистина агентска, тя вътрешно решава как да подхожда към проблема. Тя не изпълнява просто скрипт; тя автономно определя последователността от стъпки въз основа на качеството на намерената информация.
Например, ако ѝ бъде възложено да създаде стратегия за пускане на продукт, тя не разчита само на подканващо съобщение, което описва целия изследователски и процес на вземане на решения. Вместо това агентският модел независимо решава да:

1. Извлече текущи доклади за пазарните тенденции с помощта на Bing Web Grounding
2. Идентифицира релевантни данни за конкуренти чрез Azure AI Search.
3.	Свърже исторически вътрешни показатели за продажби чрез Azure SQL Database.
4. Синтезира откритията в цялостна стратегия, оркестрирана чрез Azure OpenAI Service.
5.	Оценява стратегията за пропуски или несъответствия, при необходимост инициира нов кръг на извличане.
Всички тези стъпки — усъвършенстване на заявки, избор на източници, итерация докато е „доволна“ от отговора — се решават от модела, а не са предварително скриптирани от човек.

## Итеративни цикли, интеграция на инструменти и памет

![Tool Integration Architecture](../../../translated_images/bg/tool-integration.0f569710b5c17c10.webp)

Агентската система разчита на модел на циклично взаимодействие:

- **Първоначално повикване:** Целта на потребителя (известна също като потребителска подканва) се представя на LLM.
- **Извикване на инструмент:** Ако моделът идентифицира липсваща информация или неясни инструкции, той избира инструмент или метод за извличане – като заявка в база данни по вектори (например Azure AI Search хибридно търсене върху частни данни) или структурирано SQL повикване – за събиране на допълнителен контекст.
- **Оценка и усъвършенстване:** След преглед на върнатите данни, моделът решава дали информацията е достатъчна. Ако не, той усъвършенства заявката, опитва друг инструмент или коригира подхода си.
- **Повтаряне докато е удовлетворен:** Този цикъл продължава, докато моделът прецени, че разполага с достатъчна яснота и доказателства, за да предостави финален, добре обоснован отговор.
- **Памет и състояние:** Понеже системата поддържа състояние и памет през стъпките, тя може да си спомня предишни опити и техните резултати, избягвайки повтарящи се цикли и вземайки по-информирани решения в процеса.

С течение на времето това създава усещане за развиващо се разбиране, позволявайки на модела да навигира сложни задачи с множество стъпки без нуждата от постоянна човешка намеса или адаптиране на подканващото съобщение.

## Обработка на етапи на неуспех и само-корекция

Автономността на Agentic RAG включва също устойчиви механизми за само-корекция. Когато системата срещне безизходици – като извличане на нерелевантни документи или сблъскване с неправилно форматирани заявки – тя може да:

- **Итерира и повтаря заявките:** Вместо да връща нискокачествени отговори, моделът опитва нови стратегии за търсене, пренаписва заявки към база данни или разглежда алтернативни набори от данни.
- **Използва диагностични инструменти:** Системата може да активира допълнителни функции, предназначени да ѝ помогнат да отстрани грешки в процеса на разсъждение или да потвърди коректността на извлечените данни. Инструменти като Azure AI Tracing ще бъдат важни за осигуряване на стабилна наблюдаемост и мониторинг.
- **Прибягва до човешки надзор:** За задачи с висока отговорност или при повторни неуспехи моделът може да сигнализира за несигурност и да поиска човешко ръководство. След като човек предостави корективна обратна връзка, моделът може да я интегрира за бъдещи действия.

Този итеративен и динамичен подход позволява на модела да се усъвършенства непрекъснато, гарантирайки, че той не е просто еднократна система, а такава, която учи от грешките си в рамките на дадена сесия.

![Self Correction Mechanism](../../../translated_images/bg/self-correction.da87f3783b7f174b.webp)

## Граници на агентността

Въпреки автономността си в рамките на задача, Agentic RAG не е аналогичен на Изкуствен Общ Интелект. Неговите „агентски“ възможности са ограничени до инструментите, източниците на данни и политиките, предоставени от човешките разработчици. Той не може да изобретява свои инструменти или да стъпва извън границите на домейна, които са зададени. Вместо това, той се отличава с динамично оркестриране на наличните ресурси.
Ключови разлики спрямо по-напреднали форми на ИИ включват:

1. **Автономия, специфична за домейна:** Agentic RAG системите се фокусират върху постигане на определени от потребителя цели в познат домейн, използвайки стратегии като пренаписване на заявки или избор на инструменти за подобряване на резултатите.
2. **Зависимост от инфраструктура:** Възможностите на системата зависят от инструментите и данните, интегрирани от разработчиците. Тя не може да надхвърля тези граници без човешка намеса.
3. **Уважение към защитни механизми:** Етични насоки, правила за съответствие и бизнес политики остават изключително важни. Свободата на агента винаги е ограничена от мерки за безопасност и механизми за надзор (дано така?).

## Практически случаи на употреба и стойност

Agentic RAG се отличава в сценарии, изискващи итеративно усъвършенстване и прецизност:

1. **Среда с приоритет върху коректността:** При проверки за съответствие, регулаторен анализ или правни изследвания агентският модел може многократно да проверява факти, да се консултира с множество източници и да пренаписва заявки, докато предостави цялостно проверен отговор.
2. **Сложни взаимодействия с бази данни:** При работа със структурирани данни, където заявките често могат да се провалят или се нуждаят от корекции, системата може автономно да усъвършенства заявките си чрез Azure SQL или Microsoft Fabric OneLake, гарантирайки, че крайното извличане съответства на намерението на потребителя.
3. **Разширени работни потоци:** По-дълготрайни сесии могат да се развиват с нова информация. Agentic RAG може непрекъснато да интегрира нови данни, като променя стратегии, докато научава повече за проблемната област.

## Управление, прозрачност и доверие

Тъй като тези системи стават все по-автономни в разсъжденията си, управлението и прозрачността са от ключово значение:

- **Обяснимо разсъждение:** Моделът може да предостави одитен път на направените заявки, консултираните източници и разсъжденията, довели до заключението му. Инструменти като Azure AI Content Safety и Azure AI Tracing / GenAIOps могат да помогнат за поддържане на прозрачност и намаляване на рисковете.
- **Контрол на пристрастията и балансирано извличане:** Разработчиците могат да настройват стратегии за извличане, за да гарантират, че се вземат предвид балансирани, представителни източници на данни, и редовно да одитират изходите, за да откриват пристрастия или изкривени модели, използвайки потребителски модели за напреднали организации за наука за данни чрез Azure Machine Learning.
- **Човешки надзор и съответствие:** За чувствителни задачи човешкият преглед остава съществен. Agentic RAG не замества човешката преценка при решения с висока отговорност — той я допълва, предоставяйки по-задълбочено проверени опции.

Наличието на инструменти, които предоставят ясен запис на действията, е от съществено значение. Без тях отстраняването на грешки в многостъпков процес може да бъде много трудно. Вижте следния пример от Literal AI (компанията зад Chainlit) за изпълнение на агент:

![AgentRunExample](../../../translated_images/bg/AgentRunExample.471a94bc40cbdc0c.webp)

## Заключение

Agentic RAG представлява естествена еволюция в начина, по който ИИ системите обработват сложни, интензивни на данни задачи. Чрез приемане на цикличен модел на взаимодействие, автономно избиране на инструменти и усъвършенстване на заявките докато се постигне висококачествен резултат, системата преминава отвъд статичното следване на подканите към по-адаптивен, контекстно осъзнат направляващ решения. Въпреки че остава ограничена от човешки дефинирани инфраструктури и етични насоки, тези агентски възможности позволяват по-богати, по-динамични и в крайна сметка по-полезни ИИ взаимодействия както за предприятия, така и за крайни потребители.

### Имате още въпроси относно Agentic RAG?

Присъединете се към [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord), за да се срещнете с други учащи, да посещавате работни часове и да получите отговори на въпросите си относно AI агенти.

## Допълнителни ресурси
- <a href="https://learn.microsoft.com/training/modules/use-own-data-azure-openai" target="_blank">Реализиране на Retrieval Augmented Generation (RAG) с Azure OpenAI Service: Научете как да използвате собствените си данни с Azure OpenAI Service. Този модул на Microsoft Learn предоставя цялостно ръководство за прилагането на RAG</a>
- <a href="https://learn.microsoft.com/azure/ai-studio/concepts/evaluation-approach-gen-ai" target="_blank">Оценка на генеративни AI приложения с Microsoft Foundry: Тази статия обхваща оценката и сравнението на модели върху публично достъпни набори от данни, включително агентни AI приложения и RAG архитектури</a>
- <a href="https://weaviate.io/blog/what-is-agentic-rag" target="_blank">Какво е агентен RAG | Weaviate</a>
- <a href="https://ragaboutit.com/agentic-rag-a-complete-guide-to-agent-based-retrieval-augmented-generation/" target="_blank">Agentic RAG: Пълно ръководство за агентно базирано Retrieval Augmented Generation – Новини от поколение RAG</a>
- <a href="https://huggingface.co/learn/cookbook/agent_rag" target="_blank">Agentic RAG: ускори своя RAG с преформулиране на заявки и само-извличане! Hugging Face Open-Source AI Cookbook</a>
- <a href="https://youtu.be/aQ4yQXeB1Ss?si=2HUqBzHoeB5tR04U" target="_blank">Добавяне на агентни слоеве към RAG</a>
- <a href="https://www.youtube.com/watch?v=zeAyuLc_f3Q&t=244s" target="_blank">Бъдещето на асистентите за знание: Джери Лю</a>
- <a href="https://www.youtube.com/watch?v=AOSjiXP1jmQ" target="_blank">Как да изградим агентни RAG системи</a>
- <a href="https://ignite.microsoft.com/sessions/BRK102?source=sessions" target="_blank">Използване на Microsoft Foundry Agent Service за мащабиране на вашите AI агенти</a>

### Академични статии

- <a href="https://arxiv.org/abs/2303.17651" target="_blank">2303.17651 Self-Refine: Итеративно подобрение със самообратна връзка</a>
- <a href="https://arxiv.org/abs/2303.11366" target="_blank">2303.11366 Reflexion: Езикови агенти с вербално учене чрез подсилване</a>
- <a href="https://arxiv.org/abs/2305.11738" target="_blank">2305.11738 CRITIC: Големи езикови модели могат да се коригират сами чрез интерактивно критикуване с инструменти</a>
- <a href="https://arxiv.org/abs/2501.09136" target="_blank">2501.09136 Agentic Retrieval-Augmented Generation: Преглед на агентен RAG</a>

## Предишен урок

[Tool Use Design Pattern](../04-tool-use/README.md)

## Следващ урок

[Building Trustworthy AI Agents](../06-building-trustworthy-agents/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Отказ от отговорност**:
Този документ е преведен чрез AI преводаческа услуга [Co-op Translator](https://github.com/Azure/co-op-translator). Въпреки че се стремим към точност, моля, имайте предвид, че автоматизираните преводи могат да съдържат грешки или неточности. Оригиналният документ на неговия собствен език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален човешки превод. Ние не носим отговорност за всякакви недоразумения или неправилни тълкувания, възникнали от използването на този превод.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->