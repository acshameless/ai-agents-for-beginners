[![Multi-Agent Design](../../../translated_images/bg/lesson-8-thumbnail.278a3e4a59137d62.webp)](https://youtu.be/V6HpE9hZEx0?si=A7K44uMCqgvLQVCa)

> _(Кликнете върху изображението по-горе, за да гледате видеото на този урок)_

# Мултиагентни дизайн модели

Веднага щом започнете работа по проект, който включва множество агенти, ще трябва да обмислите мултиагентния дизайн модел. Въпреки това, може да не е веднага ясно кога да преминете към множество агенти и какви са ползите.

## Въведение

В този урок ще се опитаме да отговорим на следните въпроси:

- Кои са сценариите, в които мултиагентите са приложими?
- Какви са предимствата на използването на мултиагенти вместо един единствен агент, изпълняващ множество задачи?
- Какви са основните елементи за реализиране на мултиагентния дизайн модел?
- Как имаме видимост върху това как множество агенти взаимодействат помежду си?

## Цели за учене

След този урок трябва да можете:

- Да идентифицирате сценарии, в които мултиагентите са приложими
- Да разпознавате предимствата на използването на мултиагенти вместо един единствен агент
- Да разбирате основните компоненти за реализиране на мултиагентния дизайн модел

Каква е по-голямата картина?

*Мултиагентите са дизайн модел, който позволява на множество агенти да работят заедно, за да постигнат обща цел*.

Този модел е широко използван в различни области, включително роботика, автономни системи и разпределено изчисление.

## Сценарии, в които мултиагентите са приложими

И така, кои сценарии са подходящ пример за използване на мултиагенти? Отговорът е, че има много сценарии, при които използването на множество агенти е полезно, особено в следните случаи:

- **Големи натоварвания**: Големи натоварвания могат да бъдат разделени на по-малки задачи и възложени на различни агенти, позволявайки паралелна обработка и по-бързо изпълнение. Пример за това е задача за обработка на големи обеми данни.
- **Сложни задачи**: Сложните задачи, както големите натоварвания, могат да бъдат разбити на по-малки подзадачи и възложени на различни агенти, всеки със специфична експертиза по даден аспект на задачата. Добър пример е при автономни превозни средства, където различни агенти управляват навигацията, откриването на препятствия и комуникацията с други превозни средства.
- **Разнообразна експертиза**: Различните агенти могат да имат разнообразна експертиза, позволявайки им да се справят по-ефективно с различни аспекти на задача в сравнение с един единствен агент. За този случай добър пример е здравеопазването, където агентите могат да управляват диагностика, планове за лечение и мониторинг на пациента.

## Предимства на използването на мултиагенти пред един единствен агент

Един единствен агент може да работи добре за прости задачи, но за по-сложни задачи използването на множество агенти може да предостави няколко предимства:

- **Специализация**: Всеки агент може да бъде специализиран за конкретна задача. Липсата на специализация в един единствен агент означава, че имате агент, който може да прави всичко, но може да се обърка какво да прави, когато е изправен пред сложна задача. Например може да започне да изпълнява задача, за която не е най-подходящ.
- **Мащабируемост**: По-лесно е да се мащабират системите чрез добавяне на повече агенти, вместо да се претоварва един единствен агент.
- **Устойчивост при повреди**: Ако един агент се повреди, други могат да продължат да функционират, осигурявайки надеждност на системата.

Нека вземем пример: нека резервираме пътуване за потребител. Един единствен агент трябва да се справя с всички аспекти от процеса на резервация, от намиране на полети до резервации на хотели и коли под наем. За да се постигне това с един агент, той трябва да разполага с инструменти за обслужване на всички тези задачи. Това може да доведе до сложна и монолитна система, която е трудна за поддръжка и скалиране. От друга страна, мултиагентната система може да има различни агенти, специализирани в намиране на полети, резервации на хотели и коли под наем. Това прави системата по-модулна, по-лесна за поддръжка и мащабируема.

Сравнете това с туристическа агенция, управлявана като малък семеен бизнес, срещу туристическа агенция, управлявана като франчайз. Малкият семеен бизнес би имал един агент, който се грижи за всички аспекти на процеса на резервация, докато франчайзът би имал различни агенти, които се грижат за различни аспекти.

## Основни елементи за реализиране на мултиагентния дизайн модел

Преди да можете да реализирате мултиагентния дизайн модел, трябва да разберете основните елементи, които го изграждат.

Нека направим това по-конкретно, като отново разгледаме примера с резервация на пътуване за потребител. В този случай основните елементи включват:

- **Комуникация между агенти**: Агентите за намиране на полети, резервиране на хотели и коли под наем трябва да комуникират и споделят информация за предпочитанията и ограниченията на потребителя. Трябва да вземете решение за протоколите и методите за тази комуникация. Конкретно това означава, че агентът за намиране на полети трябва да комуникира с агента за резервация на хотели, за да се увери, че хотелът е резервиран за същите дати като полета. Това означава, че агентите трябва да споделят информация за дните на пътуване на потребителя, което означава, че трябва да решите *кои агенти споделят информация и как я споделят*.
- **Механизми за координация**: Агентите трябва да координират действията си, за да гарантират, че предпочитанията и ограниченията на потребителя са спазени. Предпочитание на потребителя може да бъде хотел близо до летището, докато ограничение може да е, че колите под наем са налични само на летището. Това означава, че агентът за резервация на хотели трябва да се координира с агента за резервация на коли под наем, за да се гарантира, че предпочитанията и ограниченията са спазени. Следователно, трябва да решите *как агентите координират действията си*.
- **Архитектура на агентите**: Агентите трябва да имат вътрешна структура, която да им позволява да вземат решения и да се учат от взаимодействията с потребителя. Например, агентът за намиране на полети трябва да може да прави решения за това кои полети да препоръча на потребителя. Това означава, че трябва да решите *как агентите вземат решения и се учат от взаимодействията с потребителя*. Пример за това как агентът се учи и подобрява може да бъде използването на машинно обучение, за да препоръчва полети на базата на предишните предпочитания на потребителя.
- **Видимост върху взаимодействията между агентите**: Трябва да имате видимост върху това как множество агенти взаимодействат помежду си. Това означава, че трябва да разполагате с инструменти и техники за проследяване на дейността и взаимодействията на агентите. Това може да бъде под формата на инструменти за логване и мониторинг, визуализация и показатели за производителност.
- **Мултиагентни модели**: Има различни модели за реализиране на мултиагентни системи, като централизирана, децентрализирана и хибридна архитектури. Трябва да изберете модела, който най-добре отговаря на вашия случай.
- **Човек в цикъла**: В повечето случаи ще има човек в цикъла и трябва да инструктирате агентите кога да поискат човешка намеса. Това може да бъде под формата на потребител, който иска конкретен хотел или полет, които агентите не са препоръчали, или искане за потвърждение преди резервация.

## Видимост върху взаимодействията между мултиагенти

Важно е да имате видимост върху това как множество агенти взаимодействат помежду си. Тази видимост е от съществено значение за дебъгване, оптимизация и осигуряване на цялостната ефективност на системата. За да го постигнете, трябва да разполагате с инструменти и техники за проследяване на дейността и взаимодействията между агентите. Това може да бъде под формата на логове и мониторинг, визуализация и показатели за производителност.

Например, при резервация на пътуване за потребител, може да имате табло, което показва статуса на всеки агент, предпочитанията и ограниченията на потребителя, както и взаимодействията между агентите. Това табло може да показва датите на пътуване на потребителя, препоръчаните от агента за полети полети, хотелите препоръчани от агента за хотели и колите под наем препоръчани от агента за коли. Това ще ви даде ясна представа как агентите взаимодействат помежду си и дали предпочитанията и ограниченията на потребителя са изпълнени.

Нека разгледаме тези аспекти по-подробно.

- **Инструменти за логване и мониторинг**: Желаете всяко действие на агент да бъде записано в лога. Входът в лога може да съдържа информация за агента, който е извършил действието, самото действие, времето на действието и резултата от него. Тази информация може да бъде използвана за дебъгване, оптимизация и други.
- **Инструменти за визуализация**: Визуализациите могат да ви помогнат да видите взаимодействията между агенти по по-интуитивен начин. Например, може да имате графика, която показва потока на информация между агентите. Това може да ви помогне да идентифицирате тесни места, неефективности и други проблеми в системата.
- **Показатели за производителност**: Показателите могат да ви помогнат да следите ефективността на мултиагентната система. Например, може да измервате времето за изпълнение на задача, броя задачи, изпълнени за единица време, и точността на препоръките, дадени от агентите. Тези данни могат да ви помогнат да идентифицирате области за подобрение и да оптимизирате системата.

## Мултиагентни модели

Нека разгледаме някои конкретни модели, които можем да използваме за създаване на мултиагентни приложения. Ето някои интересни модели, които си струва да вземете предвид:

### Групов чат

Този модел е полезен, когато искате да създадете приложение за групов чат, в който множество агенти могат да комуникират помежду си. Типични случаи на употреба включват екипна колаборация, клиентска поддръжка и социални мрежи.

При този модел всеки агент представлява потребител в груповия чат, а съобщенията се обменят между агентите чрез протокол за съобщения. Агентите могат да изпращат съобщения към груповия чат, да получават съобщения от груповия чат и да отговарят на съобщения от други агенти.

Този модел може да бъде реализиран чрез централизирана архитектура, при която всички съобщения минават през централен сървър, или чрез децентрализирана архитектура, при която съобщенията се обменят директно.

![Group chat](../../../translated_images/bg/multi-agent-group-chat.ec10f4cde556babd.webp)

### Прехвърляне на задачи

Този модел е полезен, когато искате да създадете приложение, в което множество агенти могат да прехвърлят задачи помежду си.

Типични случаи на употреба включват клиентска поддръжка, управление на задачи и автоматизация на работни потоци.

При този модел всеки агент представлява задача или стъпка в работен поток, а агентите могат да прехвърлят задачи на други агенти според предварително дефинирани правила.

![Hand off](../../../translated_images/bg/multi-agent-hand-off.4c5fb00ba6f8750a.webp)

### Колаборативно филтриране

Този модел е полезен, когато искате да създадете приложение, в което множество агенти си сътрудничат, за да правят препоръки на потребители.

Защо бихте искали множество агенти да си сътрудничат? Защото всеки агент може да има различна експертиза и да допринесе към процеса на препоръки по различни начини.

Нека разгледаме пример, където потребител иска препоръка за най-добрата акция за покупка на борсата.

- **Експерт по индустрията**: Един агент може да бъде експерт в конкретна индустрия.
- **Технически анализ**: Друг агент може да е експерт в техническия анализ.
- **Фундаментален анализ**: Трети агент може да е експерт във фундаменталния анализ. Чрез сътрудничество, тези агенти могат да предоставят по-комплексна препоръка на потребителя.

![Recommendation](../../../translated_images/bg/multi-agent-filtering.d959cb129dc9f608.webp)

## Сценарий: Процес на възстановяване на суми

Разгледайте сценарий, в който клиент иска възстановяване на пари за продукт, в този процес могат да участват доста агенти, но нека ги разделим на агенти, специфични за този процес и общи агенти, които могат да бъдат използвани и в други процеси.

**Агенти, специфични за процеса на възстановяване**:

Следната група агенти биха могли да участват в процеса:

- **Агент на клиента**: Представлява клиента и е отговорен за иницииране на процеса на възстановяване.
- **Агент на продавача**: Представлява продавача и отговаря за обработката на възстановяването.
- **Агент на плащането**: Представлява процеса на плащане и отговаря за възстановяване на средствата на клиента.
- **Агент за разрешаване на проблеми**: Представлява процеса на разрешаване и отговаря за решаване на възникнали проблеми по време на процеса.
- **Агент за съответствие**: Отговаря за спазването на регулации и политики във връзка с процеса на възстановяване.

**Общи агенти**:

Тези агенти могат да бъдат използвани и в други части на вашия бизнес.

- **Агент за доставка**: Представлява процеса на доставка и отговаря за връщане на продукта обратно на продавача. Този агент може да се използва както за процеса на възстановяване, така и за общи доставки, например при покупка.
- **Агент за обратна връзка**: Представлява процеса на събиране на обратна връзка от клиента. Обратната връзка може да бъде събирана по всяко време, не само по време на процеса на възстановяване.
- **Агент за ескалация**: Отговаря за прехвърляне на проблеми към по-високо ниво на поддръжка. Този тип агент може да се използва за всеки процес, където има нужда от ескалация.
- **Агент за известия**: Отговаря за изпращане на известия до клиента на различни етапи от процеса.
- **Агент за аналитика**: Отговаря за анализа на данни, свързани с процеса на възстановяване.
- **Агент за одит**: Отговаря за одита на процеса на възстановяване, за да се увери, че той се изпълнява правилно.
- **Агент за доклади**: Отговаря за генериране на доклади за процеса на възстановяване.
- **Агент за знание**: Поддържа база знания свързана с процеса на възстановяване. Този агент може да бъде компетентен както по въпроси за възстановявания, така и за други части на бизнеса ви.
- **Агент за сигурност**: Отговаря за осигуряване на сигурността на процеса.
- **Агент за качество**: Отговаря за гарантиране на качеството на процеса на възстановяване.

По-горе са изброени доста агенти, както за специфичния процес по възстановяване, така и за общи агенти, които могат да се използват в други части на бизнеса. Надяваме се това да ви даде идея как да решите кои агенти да използвате във вашата мултиагентна система.

## Задача

Проектирайте мултиагентна система за процес на клиентска поддръжка. Идентифицирайте участващите агенти в процеса, техните роли и отговорности и как взаимодействат помежду си. Помислете както за агенти, специфични за процеса на клиентска поддръжка, така и за общи агенти, които могат да се използват в други части на вашия бизнес.
> Помислете преди да прочетете следното решение, може да ви трябват повече агенти, отколкото предполагате.

> СЪВЕТ: Помислете за различните етапи на процеса на поддръжка на клиенти и също така вземете предвид агентите, необходими за всяка система.

## Решение

[Solution](./solution/solution.md)

## Проверка на знанията

Въпрос: Кога трябва да помислите за използване на многоагентна система?

- [ ] A1: Когато имате малко натоварване и проста задача.
- [ ] A2: Когато имате голямо натоварване
- [ ] A3: Когато имате проста задача.

[Solution quiz](./solution/solution-quiz.md)

## Резюме

В този урок разгледахме многоагентния дизайн патърн, включително сценариите, в които многоагентите са приложими, предимствата на използването на многоагенти пред един единствен агент, основните компоненти за реализиране на многоагентния дизайн патърн и как да имаме видимост върху взаимодействието между множество агенти.

### Имате ли още въпроси относно многоагентния дизайн патърн?

Присъединете се към [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord), за да се срещнете с други обучаващи се, да посетите виртуални консултации и да получите отговори на въпросите си за AI агентите.

## Допълнителни ресурси

- <a href="https://microsoft.github.io/autogen/stable/user-guide/core-user-guide/design-patterns/intro.html" target="_blank">Дизайн патърни на AutoGen</a>
- <a href="https://www.analyticsvidhya.com/blog/2024/10/agentic-design-patterns/" target="_blank">Agentic дизайн патърни</a>


## Предишен урок

[Планиране на дизайн](../07-planning-design/README.md)

## Следващ урок

[Метакогниция в AI агентите](../09-metacognition/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Отказ от отговорност**:
Този документ е преведен с помощта на AI преводаческа услуга [Co-op Translator](https://github.com/Azure/co-op-translator). Въпреки че се стремим към точност, моля, имайте предвид, че автоматизираните преводи може да съдържат грешки или неточности. Оригиналният документ на неговия оригинален език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален човешки превод. Ние не носим отговорност за каквито и да било недоразумения или неправилни тълкувания, произтичащи от използването на този превод.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->