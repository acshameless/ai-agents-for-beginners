[![עיצוב רב-סוכני](../../../translated_images/he/lesson-8-thumbnail.278a3e4a59137d62.webp)](https://youtu.be/V6HpE9hZEx0?si=A7K44uMCqgvLQVCa)

> _(לחצו על התמונה למעלה כדי לצפות בסרטון של שיעור זה)_

# דפוסי עיצוב רב-סוכניים

ברגע שאתם מתחילים לעבוד על פרויקט הכולל מספר סוכנים, תצטרכו לשקול את דפוס העיצוב הרב-סוכני. עם זאת, ייתכן שלא יהיה ברור מיד מתי לעבור לרב-סוכנים ומה היתרונות בכך.

## הקדמה

בשיעור זה אנו מבקשים לענות על השאלות הבאות:

- באילו תרחישים דפוסי רב-סוכנים ישימים?
- מהם היתרונות של שימוש ברב-סוכנים על פני סוכן יחיד המבצע משימות מרובות?
- מהם אבני הבניין ליישום דפוס העיצוב הרב-סוכני?
- כיצד יש לנו נראות על האינטראקציות בין הסוכנים השונים?

## יעדי למידה

לאחר שיעור זה, עליכם להיות מסוגלים:

- לזהות תרחישים שבהם רב-סוכנים ישימים
- להכיר את היתרונות של שימוש ברב-סוכנים לעומת סוכן יחיד.
- להבין את אבני הבניין של יישום דפוס העיצוב הרב-סוכני.

מה התמונה הגדולה יותר?

*דפוס רב-סוכנים הוא דפוס עיצוב שמאפשר למספר סוכנים לעבוד יחד כדי להשיג מטרה משותפת*.

דפוס זה נפוץ במגוון תחומים, כולל רובוטיקה, מערכות אוטונומיות ומחשוב מבוזר.

## תרחישים שבהם רב-סוכנים ישימים

אז אילו תרחישים הם שימוש טוב לרב-סוכנים? התשובה היא שישנם תרחישים רבים שבהם שימוש במספר סוכנים משתלם במיוחד במקרים הבאים:

- **עומסי עבודה גדולים**: עומסי עבודה גדולים ניתנים לחלוקה למשימות קטנות יותר והקצאה לסוכנים שונים, מה שמאפשר עיבוד מקבילי והשלמת עבודה מהירה יותר. דוגמה לכך היא מטלה גדולה של עיבוד נתונים.
- **משימות מורכבות**: משימות מורכבות, כאמור, ניתנות לפירוק לתת-משימות קטנות יותר והקצאה לסוכנים שונים, כשהכלים המקצועיים של כל סוכן מתמקדים בהיבט מסוים של המשימה. דוגמה טובה לכך היא בכלי רכב אוטונומיים שבהם סוכנים שונים מנהלים ניווט, זיהוי מכשולים ותקשורת עם כלי רכב אחרים.
- **מומחיות מגוונת**: סוכנים שונים יכולים להחזיק במומחיות מגוונת, מה שמאפשר להם להתמודד עם היבטים שונים של המשימה בצורה יעילה יותר מסוכן יחיד. במקרה זה דוגמה טובה היא בתחום הבריאות, שבו סוכנים יכולים לנהל אבחונים, תוכניות טיפול ומעקב אחר מטופלים.

## יתרונות השימוש ברב-סוכנים על פני סוכן יחיד

מערכת עם סוכן יחיד יכולה לעבוד היטב למשימות פשוטות, אך למשימות מורכבות יותר שימוש במספר סוכנים יכול להעניק מספר יתרונות:

- **התמחות**: כל סוכן יכול להיות מתמחה במשימה מסוימת. חוסר התמחות בסוכן יחיד אומר שיש לכם סוכן שיכול לעשות הכל אך עלול להתבלבל כשנדרש מטלה מורכבת. הוא עלול, למשל, למצוא את עצמו מבצע משימה שאינה המתאימה ביותר לו.
- **סקלאביליות**: קל יותר להרחיב מערכות על ידי הוספת סוכנים נוספים מאשר להעמיס על סוכן יחיד.
- **סובלנות לתקלות**: אם סוכן אחד נכשל, אחרים יכולים להמשיך לפעול, מה שמבטיח אמינות מערכתית.

בואו ניקח דוגמה: נשב לטוס למשתמש. מערכת סוכן יחיד תצטרך להתמודד עם כל היבטי תהליך הזמנת הנסיעה, החל ממציאת טיסות ועד הזמנת מלונות ורכבי שכירות. כדי להשיג זאת עם סוכן יחיד, הסוכן יצטרך לכלול כלים לטיפול בכל המשימות הללו. זה עלול להוביל למערכת מורכבת ומונוליתית שקשה לתחזק ולהרחיב. מערכת רב-סוכנים, מצד שני, יכולה לכלול סוכנים שונים המתמחים במציאת טיסות, בהזמנת מלונות וברכבי שכירות. זה יהפוך את המערכת ליותר מודולרית, קלה יותר לתחזוקה ולהרחבה.

השוו זאת לסניף נסיעות משפחתי מול סוכנות נסיעות הפועלת בזכיינות. החנות המשפחתית תהיה עם סוכן יחיד המטפל בכל היבטי תהליך ההזמנה, בעוד שהזכיינית תחזיק סוכנים שונים המטפלים בהיבטים שונים של התהליך.

## אבני הבניין של יישום דפוס העיצוב הרב-סוכני

לפני שתוכלו ליישם את דפוס העיצוב הרב-סוכני, עליכם להבין את אבני הבניין המרכיבות את הדפוס.

נמחיש זאת שוב באמצעות דוגמת הזמנת נסיעה למשתמש. במקרה זה, אבני הבניין יכללו:

- **Agent Communication**: סוכנים למציאת טיסות, הזמנת מלונות ורכבי שכירות צריכים לתקשר ולשתף מידע על העדפות המשתמש והמגבלות. עליכם להחליט על הפרוטוקולים והשיטות לתקשורת זו. משמעות הדבר במישור המעשי היא שהסוכן למציאת טיסות צריך לתקשר עם הסוכן להזמנת מלונות כדי לוודא שהמלון מוזמן לאותן תאריכים של הטיסה. משמעות הדבר היא שהסוכנים צריכים לשתף מידע על תאריכי נסיעה של המשתמש, ועליכם להחליט *אילו סוכנים משתפים מידע וכיצד הם משותפים*.
- **Coordination Mechanisms**: על הסוכנים לתאם את פעולותיהם כדי להבטיח שהעדפות המשתמש והמגבלות מתקיימות. העדפה של משתמש יכולה להיות רצון שהמלון יהיה קרוב לנמל התעופה בעוד שמגבלה יכולה להיות שרכבי השכרה זמינים רק בנמל התעופה. משמעות הדבר היא שסוכן הזמנת המלונות צריך לתאם עם סוכן הזמנת רכבי השכרה כדי להבטיח שההעדפות והמגבלות של המשתמש מתקיימות. עליכם להחליט *כיצד הסוכנים מתאמים את פעולותיהם*.
- **Agent Architecture**: על הסוכנים להיות בעלי מבנה פנימי לקבלת החלטות ולמידה מהאינטראקציות שלהם עם המשתמש. משמעות הדבר היא שסוכן למציאת טיסות צריך להיות בעל מבנה פנימי שיאפשר קבלת החלטות לגבי אילו טיסות להמליץ למשתמש. עליכם להחליט *כיצד הסוכנים מקבלים החלטות ולומדים מהאינטראקציות עם המשתמש*. דוגמאות לאופן שבו סוכן לומד ומשתפר יכולות להיות שסוכן למציאת טיסות ישתמש במודל למידת מכונה כדי להמליץ על טיסות למשתמש בהתבסס על העדפותיו בעבר.
- **Visibility into Multi-Agent Interactions**: עליכם לקבל נראות על האופן שבו הסוכנים מרובים מתקשרים זה עם זה. משמעות הדבר היא שעליכם להחזיק בכלים וטכניקות למעקב אחרי פעילויות ואינטראקציות של סוכנים. זה יכול להיות בצורת כלים לרישום ומעקב, כלים להמחשה ומדדי ביצוע.
- **Multi-Agent Patterns**: ישנם דפוסים שונים ליישום מערכות רב-סוכניות, כגון ארכיטקטורות מרוכזות, מבוזרות והיברידיות. עליכם להחליט על הדפוס שמתאים ביותר למקרה השימוש שלכם.
- **Human in the loop**: ברוב המקרים יהיה לכם אדם בשרשרת וצריך להנחות את הסוכנים מתי לבקש התערבות אנושית. זה יכול להיות בצורת משתמש המבקש מלון או טיסה ספציפיים שלא הומלצו על ידי הסוכנים או בקשת אישור לפני ביצוע הזמנת טיסה או מלון.

## נראות באינטראקציות רב-סוכניות

חשוב שיהיה לכם נראות על האופן שבו הסוכנים הרבים מתקשרים זה עם זה. נראות זו חשובה לניפוי שגיאות, לאופטימיזציה ולהבטחת היעילות הכוללת של המערכת. כדי להשיג זאת, עליכם להחזיק בכלים ובטכניקות למעקב אחרי פעילויות ואינטראקציות של סוכנים. זה יכול להיות בצורת כלים לרישום ומעקב, כלים להמחשה ומדדי ביצוע.

למשל, במקרה של הזמנת נסיעה למשתמש, תוכלו להחזיק לוח מחוונים שמציג את הסטטוס של כל סוכן, את העדפות והמגבלות של המשתמש ואת האינטראקציות בין הסוכנים. לוח זה יכול להציג את תאריכי הנסיעה של המשתמש, את הטיסות שהומלצו על ידי סוכן הטיסות, את המלונות שהומלצו על ידי סוכן המלון ואת רכבי השכרה שהומלצו על ידי סוכן רכבי השכרה. זה יתן לכם תמונה ברורה של האופן שבו הסוכנים מתקשרים זה עם זה והאם העדפות ומגבלות המשתמש מתקיימות.

בואו נבחן כל אחד מההיבטים האלה בפירוט רב יותר.

- **Logging and Monitoring Tools**: רצוי לבצע רישום עבור כל פעולה שננקטת על ידי סוכן. רשומת לוג יכולה לאחסן מידע על הסוכן שנקט בפעולה, הפעולה שננקטה, הזמן שבו הפעולה נעשתה ותוצאת הפעולה. מידע זה יכול לשמש לניפוי שגיאות, לאופטימיזציה ולמטרות נוספות.
- **Visualization Tools**: כלים להמחשה יכולים לעזור לכם לראות את האינטראקציות בין סוכנים באופן אינטואיטיבי יותר. לדוגמה, תוכלו להחזיק גרף המציג את הזרימה של מידע בין הסוכנים. זה יכול לעזור לזהות צווארי בקבוק, חוסר יעילות ועניינים נוספים במערכת.
- **Performance Metrics**: מדדי ביצוע יכולים לעזור לכם לעקוב אחרי היעילות של מערכת הרב-סוכנים. לדוגמה, תוכלו לעקוב אחרי הזמן שלוקח להשלים משימה, מספר המשימות המושלמות ליחידת זמן ודיוק ההמלצות שניתנו על ידי הסוכנים. מידע זה יכול לסייע בזיהוי אזורים לשיפור ואופטימיזציה של המערכת.

## דפוסי רב-סוכנים

נצלול לכמה דפוסים קונקרטיים שניתן להשתמש בהם ליצירת אפליקציות רב-סוכניות. הנה כמה דפוסים מעניינים שכדאי לשקול:

### צ'אט קבוצתי

דפוס זה שימושי כאשר רוצים ליצור יישום צ'אט קבוצתי שבו מספר סוכנים יכולים לתקשר זה עם זה. שימושים טיפוסיים לדפוס זה כוללים שיתוף פעולה צוותי, תמיכת לקוחות ורשתות חברתיות.

בדפוס זה, כל סוכן מייצג משתמש בשיחת הקבוצה, והודעות מוחלפות בין הסוכנים באמצעות פרוטוקול הודעות. הסוכנים יכולים לשלוח הודעות לשיחת הקבוצה, לקבל הודעות מהשיחה ולהשיב להודעות של סוכנים אחרים.

דפוס זה ניתן ליישום באמצעות ארכיטקטורה מרוכזת שבה כל ההודעות מנותבות דרך שרת מרכזי, או ארכיטקטורה מבוזרת שבה ההודעות מוחלפות ישירות.

![צ'אט קבוצתי](../../../translated_images/he/multi-agent-group-chat.ec10f4cde556babd.webp)

### העברה

דפוס זה שימושי כאשר רוצים ליצור יישום שבו מספר סוכנים יכולים להעביר משימות זה לזה.

שימושים טיפוסיים לדפוס זה כוללים תמיכת לקוחות, ניהול משימות ואוטומציה של תהליכי עבודה.

בדפוס זה, כל סוכן מייצג משימה או שלב בתהליך עבודה, וסוכנים יכולים להעביר משימות לסוכנים אחרים על בסיס כללים שהוגדרו מראש.

![העברה](../../../translated_images/he/multi-agent-hand-off.4c5fb00ba6f8750a.webp)

### סינון שיתופי

דפוס זה שימושי כאשר רוצים ליצור יישום שבו מספר סוכנים משתפים פעולה כדי להעניק המלצות למשתמשים.

מדוע תרצו שסוכנים מרובים ישתפו פעולה? מכיוון שכל סוכן יכול להחזיק במומחיות שונה ולתרום לתהליך ההמלצה בדרכים שונות.

ניקח דוגמה שבה משתמש רוצה המלצה על המניה הטובה ביותר לקנייה בבורסה.

- **מומחה לתעשייה**:. סוכן אחד יכול להיות מומחה בענף ספציפי.
- **ניתוח טכני**: סוכן אחר יכול להיות מומחה בניתוח טכני.
- **ניתוח בסיסי**: וסוכן נוסף יכול להיות מומחה בניתוח יסודות פיננסיים. באמצעות שיתוף פעולה, סוכנים אלה יכולים לספק המלצה מקיפה יותר למשתמש.

![המלצה](../../../translated_images/he/multi-agent-filtering.d959cb129dc9f608.webp)

## תרחיש: תהליך החזר כספי

שקלו תרחיש שבו לקוח מנסה לקבל החזר עבור מוצר; יכול להיות מעורבים מספר סוכנים בתהליך זה אך נחלק אותם בין סוכנים המיועדים לתהליך זה וסוכנים כלליים שניתן להשתמש בהם בתהליכים אחרים.

**סוכנים המיועדים לתהליך ההחזר**:

להלן כמה סוכנים שעשויים להיות מעורבים בתהליך ההחזר:

- **סוכן הלקוח**: סוכן זה מייצג את הלקוח ואחראי על ייזום תהליך ההחזר.
- **סוכן המוכר**: סוכן זה מייצג את המוכר ואחראי על עיבוד ההחזר.
- **סוכן התשלום**: סוכן זה מייצג את תהליך התשלום ואחראי על החזרת התשלום ללקוח.
- **סוכן פתרון**: סוכן זה מייצג את תהליך הפתרון ואחראי על פתרון בעיות העולות במהלך תהליך ההחזר.
- **סוכן ציות**: סוכן זה מייצג את תהליך הציות ואחראי על הבטחת התאימות של תהליך ההחזר לרגולציות ולמדיניות.

**סוכנים כלליים**:

סוכנים אלה ניתנים לשימוש על ידי חלקים אחרים בעסק שלכם.

- **סוכן משלוחים**: סוכן זה מייצג את תהליך המשלוח ואחראי על החזרת המוצר למוכר. סוכן זה ניתן לשימוש הן בתהליך ההחזר והן למשלוח כללי של מוצר עקב רכישה, לדוגמה.
- **סוכן משוב**: סוכן זה מייצג את תהליך המשוב ואחראי על איסוף משוב מהלקוח. משוב יכול להתקבל בכל עת ולא רק במהלך תהליך ההחזר.
- **סוכן הסלמה**: סוכן זה מייצג את תהליך ההסלמה ואחראי על הסלמת בעיות לרמת תמיכה גבוהה יותר. תוכלו להשתמש בסוג זה של סוכן בכל תהליך שבו יש צורך להעלות בעיה.
- **סוכן התראות**: סוכן זה מייצג את תהליך ההודעות ואחראי על שליחת התראות ללקוח בשלבים שונים של תהליך ההחזר.
- **סוכן ניתוח נתונים**: סוכן זה מייצג את תהליך הניתוח ואחראי על ניתוח נתונים הקשורים לתהליך ההחזר.
- **סוכן ביקורת**: סוכן זה מייצג את תהליך הביקורת ואחראי על ביקורת תהליך ההחזר כדי להבטיח שהוא מתבצע כהלכה.
- **סוכן דוחות**: סוכן זה מייצג את תהליך הדיווח ואחראי על יצירת דוחות בנוגע לתהליך ההחזר.
- **סוכן ידע**: סוכן זה מייצג את תהליך הידע ואחראי על תחזוקת מאגר ידע של מידע הקשור לתהליך ההחזר. סוכן זה יכול להיות בעל ידע גם על החזרים וגם על חלקים אחרים בעסק שלכם.
- **סוכן אבטחה**: סוכן זה מייצג את תהליך האבטחה ואחראי על הבטחת אבטחת תהליך ההחזר.
- **סוכן איכות**: סוכן זה מייצג את תהליך האיכות ואחראי על הבטחת איכות תהליך ההחזר.

רשימת הסוכנים שלעיל כוללת לא מעט סוכנים הן לתהליך ההחזר הספציפי והן לסוכנים כלליים הניתנים לשימוש בחלקים אחרים של העסק שלכם. מקווה שזה נותן לכם מושג כיצד להחליט אילו סוכנים להשתמש במערכת הרב-סוכנית שלכם.

## מטלה

עצבו מערכת רב-סוכנית עבור תהליך תמיכת לקוחות. הגדירו את הסוכנים המעורבים בתהליך, את התפקידים והאחריות שלהם, ואת האופן שבו הם מתקשרים זה עם זה. שקלו גם סוכנים הייחודיים לתמיכת לקוחות וגם סוכנים כלליים שאפשר להשתמש בהם בחלקים אחרים של העסק שלכם.
> חשוב לחשוב לפני שתקרא את הפתרון הבא, ייתכן שתצטרך יותר סוכנים ממה שנדמה לך.
>
> טיפ: חשוב על שלבי התהליך השונים של שירות הלקוחות ושקול גם סוכנים הנדרשים לכל מערכת.

## פתרון

[פתרון](./solution/solution.md)

## בדיקות ידע

שאלה: מתי כדאי לשקול שימוש בריבוי סוכנים?

- [ ] A1: כאשר יש עומס עבודה קטן ומשימה פשוטה.
- [ ] A2: כאשר יש עומס עבודה גדול
- [ ] A3: כאשר המשימה פשוטה.

[חידון הפתרון](./solution/solution-quiz.md)

## סיכום

בשיעור זה בחנו את דפוס העיצוב של ריבוי סוכנים, כולל התרחישים שבהם ריבוי סוכנים רלוונטי, היתרונות של שימוש בריבוי סוכנים לעומת סוכן בודד, המרכיבים הבסיסיים ליישום דפוס העיצוב של ריבוי סוכנים, וכיצד להשיג נראות לאופן שבו הסוכנים השונים מתקשרים זה עם זה.

### יש לך עוד שאלות לגבי דפוס העיצוב של ריבוי סוכנים?

הצטרפו ל-[Microsoft Foundry Discord](https://aka.ms/ai-agents/discord) כדי להיפגש עם לומדים אחרים, להשתתף בשעות ייעוץ ולקבל תשובות על שאלותיכם לגבי סוכני ה-AI.

## מקורות נוספים

- <a href="https://microsoft.github.io/autogen/stable/user-guide/core-user-guide/design-patterns/intro.html" target="_blank">דפוסי עיצוב של AutoGen</a>
- <a href="https://www.analyticsvidhya.com/blog/2024/10/agentic-design-patterns/" target="_blank">דפוסי עיצוב מבוססי סוכנים</a>


## שיעור קודם

[תכנון ועיצוב](../07-planning-design/README.md)

## השיעור הבא

[מטה-קוגניציה בסוכני ה-AI](../09-metacognition/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
הצהרת אחריות:
מסמך זה תורגם באמצעות שירות תרגום מבוסס בינה מלאכותית [Co-op Translator](https://github.com/Azure/co-op-translator). אמנם אנו שואפים לדייק, אך יש לקחת בחשבון שתרגומים אוטומטיים עלולים להכיל שגיאות או אי-דיוקים. יש להתייחס למסמך המקורי בשפת המקור כמקור הסמכות. לגבי מידע קריטי מומלץ להיעזר בתרגום מקצועי שבוצע על ידי בני אדם. איננו נושאים באחריות לכל אי-הבנה או פרשנות מוטעית הנובעים משימוש בתרגום זה.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->