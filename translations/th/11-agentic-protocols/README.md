# การใช้โปรโตคอลตัวแทน (MCP, A2A และ NLWeb)

[![Agentic Protocols](../../../translated_images/th/lesson-11-thumbnail.b6c742949cf1ce2a.webp)](https://youtu.be/X-Dh9R3Opn8)

> _(คลิกที่รูปภาพด้านบนเพื่อดูวิดีโอของบทเรียนนี้)_

เมื่อตัวแทน AI มีการใช้งานเพิ่มขึ้น ความจำเป็นที่จะมีโปรโตคอลที่รับประกันมาตรฐาน ความปลอดภัย และสนับสนุนการนวัตกรรมเปิดก็เพิ่มขึ้นด้วย บทเรียนนี้เราจะครอบคลุมโปรโตคอล 3 ตัวที่มุ่งตอบสนองความต้องการนี้ - Model Context Protocol (MCP), Agent to Agent (A2A) และ Natural Language Web (NLWeb)

## บทนำ

ในบทเรียนนี้ เราจะครอบคลุม:

• วิธีที่ **MCP** ช่วยให้ตัวแทน AI เข้าถึงเครื่องมือและข้อมูลภายนอกเพื่อตอบสนองงานของผู้ใช้

• วิธีที่ **A2A** เปิดโอกาสให้ตัวแทน AI สื่อสารและทำงานร่วมกันระหว่างตัวแทนต่าง ๆ 

• วิธีที่ **NLWeb** นำเสนอส่วนติดต่อภาษาแบบธรรมชาติเข้าสู่เว็บไซต์ใด ๆ ช่วยให้ตัวแทน AI ค้นพบและโต้ตอบกับเนื้อหาได้

## เป้าหมายการเรียนรู้

• **ระบุ** จุดมุ่งหมายหลักและประโยชน์ของ MCP, A2A และ NLWeb ในบริบทของตัวแทน AI

• **อธิบาย** วิธีที่แต่ละโปรโตคอลช่วยส่งเสริมการสื่อสารและปฏิสัมพันธ์ระหว่าง LLMs, เครื่องมือ และตัวแทนอื่น ๆ

• **รับรู้** บทบาทที่แตกต่างกันของแต่ละโปรโตคอลในการสร้างระบบตัวแทนที่ซับซ้อน

## Model Context Protocol

**Model Context Protocol (MCP)** คือมาตรฐานเปิดที่จัดเตรียมวิธีการมาตรฐานสำหรับแอปพลิเคชันเพื่อให้บริบทและเครื่องมือกับ LLMs ได้ นี่ทำให้เกิด "อแดปเตอร์สากล" สำหรับแหล่งข้อมูลและเครื่องมือต่าง ๆ ที่ตัวแทน AI สามารถเชื่อมต่อได้อย่างสอดคล้องกัน

เรามาดูส่วนประกอบของ MCP ประโยชน์เปรียบเทียบกับการใช้งาน API โดยตรง และตัวอย่างการใช้งาน MCP server โดยตัวแทน AI กัน

### ส่วนประกอบหลักของ MCP

MCP ทำงานในสถาปัตยกรรม **Client-Server** ส่วนประกอบหลักคือ:

• **Hosts** คือแอป LLM (เช่น โปรแกรมแก้ไขโค้ดอย่าง VSCode) ที่เริ่มการเชื่อมต่อกับ MCP Server

• **Clients** คือส่วนประกอบภายในแอปโฮสต์ที่รักษาการเชื่อมต่อแบบหนึ่งต่อหนึ่งกับเซิร์ฟเวอร์

• **Servers** คือโปรแกรมขนาดเล็กที่เผยแพร่ความสามารถเฉพาะ

ในโปรโตคอลมีสาม primitive หลักซึ่งเป็นความสามารถของ MCP Server:

• **Tools**: คือการกระทำหรือฟังก์ชันแยกส่วนที่ตัวแทน AI สามารถเรียกใช้เพื่อทำงาน เช่น บริการสภาพอากาศอาจเปิดเผยเครื่องมือ "get weather" หรือเซิร์ฟเวอร์อีคอมเมิร์ซอาจเปิดเผยเครื่องมือ "purchase product" MCP servers จะโฆษณาชื่อเครื่องมือ คำอธิบาย และแผนผังการรับส่งข้อมูล (input/output schema) ในรายการความสามารถ

• **Resources**: คือข้อมูลหรือเอกสารอ่านอย่างเดียวที่ MCP server สามารถให้ได้ และไคลเอนต์สามารถดึงได้ตามต้องการ เช่น เนื้อหาไฟล์, ระเบียนฐานข้อมูล, หรือไฟล์บันทึก ข้อมูลเหล่านี้อาจเป็นข้อความ (เช่น โค้ด หรือ JSON) หรือไบนารี่ (เช่น รูปภาพ หรือ PDF)

• **Prompts**: คือแม่แบบที่กำหนดไว้ล่วงหน้าซึ่งให้ prompt ที่แนะนำ ช่วยให้จัดการ workflow ที่ซับซ้อนได้

### ประโยชน์ของ MCP

MCP มีข้อได้เปรียบมากมายสำหรับตัวแทน AI:

• **การค้นพบเครื่องมือแบบไดนามิก**: ตัวแทนสามารถรับรายการเครื่องมือที่พร้อมใช้จากเซิร์ฟเวอร์พร้อมคำอธิบายวิธีใช้ แตกต่างจาก API แบบดั้งเดิมซึ่งมักต้องเขียนโค้ดแบบสแตติกสำหรับการเชื่อมต่อ หมายความว่าการเปลี่ยนแปลง API จะต้องอัปเดตโค้ด MCP ให้วิธีการ "integrate once" ที่มีความยืดหยุ่นมากกว่า

• **การทำงานร่วมกันข้าม LLMs**: MCP ทำงานได้กับ LLMs ต่าง ๆ ให้ความยืดหยุ่นในการเปลี่ยนโมเดลหลักเพื่อประเมินประสิทธิภาพที่ดีกว่า

• **ความปลอดภัยมาตรฐาน**: MCP รวมวิธีการพิสูจน์ตัวตนมาตรฐาน ช่วยเพิ่มขนาดได้ง่ายเมื่อต้องเข้าถึง MCP servers เพิ่มเติม ซึ่งง่ายกว่าการจัดการคีย์และประเภทการพิสูจน์ตัวตนที่แตกต่างกันใน API แบบดั้งเดิม

### ตัวอย่าง MCP

![MCP Diagram](../../../translated_images/th/mcp-diagram.e4ca1cbd551444a1.webp)

สมมุติว่าผู้ใช้ต้องการจองเที่ยวบินโดยใช้ผู้ช่วย AI ที่ขับเคลื่อนด้วย MCP

1. **การเชื่อมต่อ**: ผู้ช่วย AI (ไคลเอนต์ MCP) เชื่อมต่อกับ MCP server ที่สายการบินให้บริการ

2. **การค้นพบเครื่องมือ**: ไคลเอนต์สอบถาม MCP server ของสายการบินว่า "มีเครื่องมืออะไรบ้าง?" เซิร์ฟเวอร์ตอบด้วยเครื่องมือเช่น "search flights" และ "book flights"

3. **การเรียกใช้เครื่องมือ**: ผู้ใช้สั่งผู้ช่วย AI ว่า "โปรดค้นหาเที่ยวบินจากพอร์ตแลนด์ไปโฮโนลูลู" ผู้ช่วย AI ใช้ LLM ของตนระบุว่าจำเป็นต้องเรียกเครื่องมือ "search flights" พร้อมส่งพารามิเตอร์ที่เกี่ยวข้อง (ต้นทาง, ปลายทาง) ไปยัง MCP server

4. **การดำเนินการและการตอบสนอง**: MCP server ทำหน้าที่เป็นตัวห่อหุ้ม เรียกใช้ API การจองภายในของสายการบินจริง ๆ จากนั้นรับข้อมูลเที่ยวบิน (เช่น ข้อมูล JSON) และส่งกลับไปยังผู้ช่วย AI

5. **การโต้ตอบเพิ่มเติม**: ผู้ช่วย AI แสดงตัวเลือกเที่ยวบิน เมื่อผู้ใช้เลือกเที่ยวบิน ผู้ช่วยอาจเรียกใช้เครื่องมือ "book flight" บน MCP server เดียวกันเพื่อทำการจองให้เสร็จสิ้น

## โปรโตคอล Agent-to-Agent (A2A)

ในขณะที่ MCP มุ่งในการเชื่อมต่อ LLM กับเครื่องมือ โปรโตคอล **Agent-to-Agent (A2A)** ก้าวไปอีกขั้นด้วยการเปิดโอกาสให้ตัวแทน AI ต่างตัวสามารถสื่อสารและทำงานร่วมกันได้ A2A เชื่อมต่อตัวแทน AI จากองค์กร สภาพแวดล้อม และเทคโนโลยีต่าง ๆ เพื่อร่วมกันทำงานให้สำเร็จ

เราจะพิจารณาส่วนประกอบและประโยชน์ของ A2A พร้อมตัวอย่างการใช้ในแอปท่องเที่ยวของเรา

### ส่วนประกอบหลักของ A2A

A2A มุ่งสร้างการสื่อสารระหว่างตัวแทนและให้พวกเขาทำงานร่วมกันเพื่อสำเร็จส่วนงานย่อยของผู้ใช้ ส่วนประกอบแต่ละอย่างทำหน้าที่ดังนี้

#### Agent Card

คล้ายกับการที่ MCP server แสดงรายการเครื่องมือ, Agent Card มี:

- ชื่อตัวแทน

- **คำอธิบายงานทั่วไป** ที่ตัวแทนทำได้

- **รายการทักษะเฉพาะพร้อมคำอธิบาย** ช่วยให้ตัวแทนอื่นหรือผู้ใช้มนุษย์เข้าใจเวลาที่ควรเรียกใช้ตัวแทนนี้

- **URL Endpoint ปัจจุบัน** ของตัวแทน

- **เวอร์ชัน** และ **ความสามารถ** ของตัวแทน เช่น การสตรีมการตอบสนองและการแจ้งเตือนแบบพุช

#### Agent Executor

Agent Executor รับผิดชอบ **ส่งต่อบริบทการสนทนาของผู้ใช้ไปยังตัวแทนระยะไกล** ซึ่งตัวแทนระยะไกลต้องใช้บริบทนี้เพื่อเข้าใจงานที่ต้องทำ ใน A2A server ตัวแทนใช้โมเดลภาษาขนาดใหญ่ (LLM) ของตนเองเพื่อแยกวิเคราะห์คำร้องและดำเนินงานโดยใช้เครื่องมือภายใน

#### Artifact

เมื่อเรียบร้อยแล้ว ตัวแทนระยะไกลจะสร้างผลงานที่เรียกว่า artifact ซึ่ง **ประกอบด้วยผลลัพธ์ของงานตัวแทน** , **คำอธิบายสิ่งที่ทำเสร็จ** และ **บริบทข้อความ** ที่ถูกส่งผ่านโปรโตคอล หลังส่ง artifact เสร็จ การเชื่อมต่อกับตัวแทนระยะไกลจะถูกปิดจนกว่าจะต้องใช้ใหม่

#### Event Queue

ส่วนนี้ใช้สำหรับ **จัดการอัปเดตและส่งผ่านข้อความ** สิ่งนี้สำคัญในระบบตัวแทนเพื่อป้องกันการปิดการเชื่อมต่อระหว่างตัวแทนก่อนงานจะเสร็จ โดยเฉพาะเมื่อเวลาทำงานอาจใช้เวลานาน

### ประโยชน์ของ A2A

• **การทำงานร่วมที่พัฒนาขึ้น**: ช่วยให้ตัวแทนจากผู้จำหน่ายและแพลตฟอร์มต่าง ๆ สามารถโต้ตอบ แบ่งปันบริบท และทำงานร่วมกันอย่างราบรื่น สร้างระบบอัตโนมัติที่เชื่อมต่อระหว่างระบบที่แยกกันอย่างดั้งเดิม

• **ความยืดหยุ่นในการเลือกโมเดล**: ตัวแทน A2A แต่ละตัวสามารถเลือก LLM ที่ใช้งานได้เอง เพื่อปรับแต่งหรือเลือกโมเดลที่ดีที่สุดสำหรับงานตัวเอง ต่างจากการเชื่อมต่อ LLM เดียวในสถานการณ์บางแบบของ MCP

• **การพิสูจน์ตัวตนในตัวโปรโตคอล**: การพิสูจน์ตัวตนถูกรวมเข้ากับ A2A โดยตรง ให้กรอบความปลอดภัยที่เข้มแข็งสำหรับการโต้ตอบตัวแทน

### ตัวอย่าง A2A

![A2A Diagram](../../../translated_images/th/A2A-Diagram.8666928d648acc26.webp)

ขยายตัวอย่างการจองท่องเที่ยวของเรา โดยใช้ A2A

1. **คำขอผู้ใช้ไปยังตัวแทนหลายตัว**: ผู้ใช้โต้ตอบกับ "Travel Agent" ตัวแทน/ไคลเอนต์ A2A อาจพูดว่า "โปรดจองทริปทั้งหมดไปโฮโนลูลูสำหรับสัปดาห์หน้า รวมเที่ยวบิน โรงแรม และรถเช่า"

2. **การจัดการโดย Travel Agent**: Travel Agent ได้รับคำขอที่ซับซ้อนนี้ ใช้ LLM ของตนคิดวิเคราะห์งานและระบุว่าต้องติดต่อกับตัวแทนเฉพาะทางอื่น ๆ

3. **การสื่อสารระหว่างตัวแทน**: Travel Agent ใช้โปรโตคอล A2A เชื่อมต่อกับตัวแทนปลายทาง เช่น "Airline Agent", "Hotel Agent" และ "Car Rental Agent" ซึ่งสร้างโดยบริษัทต่างกัน

4. **มอบหมายการทำงาน**: Travel Agent ส่งงานย่อย ๆ ไปยังตัวแทนเฉพาะด้านเหล่านั้น (เช่น "ค้นหาเที่ยวบินไปโฮโนลูลู", "จองโรงแรม", "เช่ารถ") ตัวแทนเฉพาะทางแต่ละตัว ใช้ LLM ของตนเองและเครื่องมือของตนเอง (ซึ่งอาจเป็น MCP servers) ดำเนินงานส่วนของการจอง

5. **ผลลัพธ์รวม**: เมื่อทุกตัวแทนเสร็จงาน Travel Agent รวบรวมผลลัพธ์ (รายละเอียดเที่ยวบิน, การยืนยันโรงแรม, การจองรถเช่า) แล้วส่งคำตอบสไตล์แชตกลับให้ผู้ใช้

## Natural Language Web (NLWeb)

เว็บไซต์เป็นวิธีหลักที่ผู้ใช้เข้าถึงข้อมูลและข้อมูลต่าง ๆ บนอินเทอร์เน็ตมาอย่างยาวนาน

มาดูส่วนประกอบต่าง ๆ ของ NLWeb ประโยชน์ และตัวอย่างการทำงานของ NLWeb กับแอปท่องเที่ยวของเรากัน

### ส่วนประกอบของ NLWeb

- **NLWeb Application (โค้ดบริการหลัก)**: ระบบที่ประมวลผลคำถามภาษาธรรมชาติ เชื่อมโยงส่วนต่าง ๆ ของแพลตฟอร์มเพื่อสร้างการตอบกลับ คุณสามารถคิดว่ามันคือ **เครื่องจักรที่ขับเคลื่อนฟีเจอร์ภาษาธรรมชาติของเว็บไซต์**

- **NLWeb Protocol**: เป็น **ชุดกฎพื้นฐานสำหรับการโต้ตอบภาษาธรรมชาติกับเว็บไซต์** ส่งกลับการตอบในรูปแบบ JSON (มักใช้ Schema.org) จุดประสงค์คือสร้างรากฐานง่าย ๆ สำหรับ “เว็บ AI” ในลักษณะเดียวกับที่ HTML ทำให้เอกสารสามารถแชร์ออนไลน์ได้

- **MCP Server (Model Context Protocol Endpoint)**: การตั้งค่า NLWeb ทุกชุดก็ทำงานเป็น **MCP server** หมายความว่าสามารถ **แชร์เครื่องมือ (เช่น วิธี ask) และข้อมูล** กับระบบ AI อื่น ๆ ได้ ในทางปฏิบัติ ทำให้เนื้อหาและความสามารถบนเว็บไซต์ใช้โดยตัวแทน AI ได้ ช่วยให้เว็บไซต์เป็นส่วนหนึ่งของ “ระบบนิเวศตัวแทน” ที่กว้างขึ้น

- **Embedding Models**: โมเดลเหล่านี้ใช้สำหรับ **แปลงเนื้อหาเว็บไซต์เป็นตัวแทนตัวเลขที่เรียกเวกเตอร์ (embeddings)** เวกเตอร์เหล่านี้จับความหมายในลักษณะที่คอมพิวเตอร์สามารถนำมาเปรียบเทียบและค้นหาได้ พวกมันถูกเก็บในฐานข้อมูลพิเศษ และผู้ใช้สามารถเลือกโมเดล embedding ที่ต้องการใช้ได้

- **Vector Database (กลไกค้นคืน)**: ฐานข้อมูลนี้ **เก็บ embeddings ของเนื้อหาเว็บไซต์** เมื่อมีคนถามคำถาม NLWeb จะค้นหาที่ฐานข้อมูลเวกเตอร์นี้เพื่อค้นหาข้อมูลที่เกี่ยวข้องโดยรวดเร็ว ให้รายการคำตอบที่เป็นไปได้โดยจัดอันดับตามความคล้ายคลึง NLWeb ทำงานร่วมกับระบบเก็บเวกเตอร์หลายชนิด เช่น Qdrant, Snowflake, Milvus, Azure AI Search และ Elasticsearch

### ตัวอย่าง NLWeb

![NLWeb](../../../translated_images/th/nlweb-diagram.c1e2390b310e5fe4.webp)

ลองมาดูเว็บไซต์จองท่องเที่ยวของเราอีกครั้ง แต่คราวนี้ใช้ NLWeb

1. **การนำเข้าข้อมูล**: แคตตาล็อกสินค้าที่มีอยู่ของเว็บไซต์ท่องเที่ยว (เช่น รายการเที่ยวบิน คำบรรยายโรงแรม แพ็กเกจทัวร์) ถูกจัดรูปแบบด้วย Schema.org หรือโหลดผ่านฟีด RSS เครื่องมือของ NLWeb นำเข้าข้อมูลนี้ สร้าง embeddings และเก็บในฐานข้อมูลเวกเตอร์ท้องถิ่นหรือระยะไกล

2. **การถามคำถามด้วยภาษาธรรมชาติ (มนุษย์)**: ผู้ใช้เข้าชมเว็บไซต์และแทนที่จะเลือกเมนู พิมพ์ข้อความในอินเตอร์เฟซแชตว่า "หาที่พักสำหรับครอบครัวในโฮโนลูลูที่มีสระว่ายน้ำสำหรับสัปดาห์หน้า"

3. **การประมวลผลของ NLWeb**: แอป NLWeb รับคำถาม ส่งคำถามไปยัง LLM เพื่อทำความเข้าใจ ขณะเดียวกันก็ค้นหาฐานข้อมูลเวกเตอร์เพื่อหาข้อมูลโรงแรมที่เกี่ยวข้อง

4. **ผลลัพธ์แม่นยำ**: LLM ช่วยตีความผลการค้นหาในฐานข้อมูล ระบุรายการที่ตรงกับเกณฑ์ “เหมาะสำหรับครอบครัว” “มีสระว่ายน้ำ” และ “โฮโนลูลู” จากนั้นจัดรูปแบบคำตอบเป็นภาษาธรรมชาติ จุดสำคัญคือคำตอบอ้างอิงโรงแรมจริงจากแคตตาล็อกเว็บไซต์ ไม่ได้แต่งข้อมูลขึ้นเอง

5. **การโต้ตอบของตัวแทน AI**: เนื่องจาก NLWeb ทำหน้าที่เป็น MCP server ตัวแทนท่องเที่ยว AI ภายนอกก็สามารถเชื่อมต่อกับ NLWeb instance นี้ได้ ตัวแทน AI อาจใช้วิธีการ `ask` ของ MCP เพื่อสอบถามเว็บไซต์โดยตรง เช่น `ask("มีร้านอาหารมังสวิรัติแนะนำในพื้นที่โฮโนลูลูที่โรงแรมเสนอไหม?")` NLWeb จะประมวลผลโดยใช้ฐานข้อมูลร้านอาหาร (ถ้ามีการโหลดไว้) และส่งตอบกลับเป็น JSON ที่จัดโครงสร้างเรียบร้อย

### มีคำถามเพิ่มเติมเกี่ยวกับ MCP/A2A/NLWeb ไหม?

เข้าร่วม [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord) เพื่อพบผู้เรียนคนอื่น ๆ เข้าร่วมชั่วโมงทำงาน และสอบถามคำถามเกี่ยวกับ AI Agents ของคุณ

## แหล่งข้อมูล

- [MCP for Beginners](https://aka.ms/mcp-for-beginners)  
- [เอกสาร MCP](https://github.com/microsoft/semantic-kernel/tree/main/python/semantic-kernel/semantic_kernel/connectors/mcp)
- [NLWeb Repo](https://github.com/nlweb-ai/NLWeb)
- [คู่มือ Semantic Kernel](https://learn.microsoft.com/semantic-kernel/)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**ข้อจำกัดความรับผิดชอบ**:  
เอกสารนี้ได้รับการแปลโดยใช้บริการแปลภาษาด้วย AI [Co-op Translator](https://github.com/Azure/co-op-translator) แม้เราจะพยายามให้มีความถูกต้อง แต่โปรดทราบว่าการแปลโดยอัตโนมัติอาจมีข้อผิดพลาดหรือความคลาดเคลื่อน เอกสารต้นฉบับในภาษาต้นทางถือเป็นแหล่งข้อมูลที่น่าเชื่อถือ สำหรับข้อมูลที่สำคัญ แนะนำให้ใช้บริการแปลโดยผู้เชี่ยวชาญมนุษย์เป็นหลัก เราจะไม่รับผิดชอบต่อความเข้าใจผิดหรือการตีความที่ผิดพลาดใดๆ ที่เกิดจากการใช้การแปลนี้
<!-- CO-OP TRANSLATOR DISCLAIMER END -->