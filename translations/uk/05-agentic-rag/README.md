[![Agentic RAG](../../../translated_images/uk/lesson-5-thumbnail.20ba9d0c0ae64fae.webp)](https://youtu.be/WcjAARvdL7I?si=BCgwjwFb2yCkEhR9)

> _(Натисніть на зображення вище, щоб переглянути відео цього уроку)_

# Agentic RAG

Цей урок дає всебічний огляд Agentic Retrieval-Augmented Generation (Agentic RAG) — нової парадигми в AI, у якій великі мовні моделі (LLM) автономно планують свої наступні кроки, одночасно витягаючи інформацію з зовнішніх джерел. На відміну від статичних шаблонів «витягни — прочитай», Agentic RAG передбачає ітеративні виклики LLM, чергування з викликами інструментів або функцій та структуровані результати. Система оцінює результати, уточнює запити, за потреби викликає додаткові інструменти й продовжує цей цикл, доки не досягне задовільного рішення.

## Вступ

У цьому уроці ви дізнаєтесь

- **Розуміння Agentic RAG:** Дізнатись про нову парадигму в AI, де великі мовні моделі (LLM) автономно планують свої наступні кроки, витягуючи інформацію з зовнішніх джерел даних.
- **Осягнути ітеративний стиль Maker-Checker:** Зрозуміти цикл ітеративних викликів LLM, у який вплетені виклики інструментів або функцій та структуровані виходи, розроблений для підвищення коректності та обробки некоректних запитів.
- **Дослідити практичні застосування:** Визначити сценарії, де Agentic RAG показує себе найкраще, такі як середовища з пріоритетом на коректність, складні взаємодії з базами даних та тривалі робочі процеси.

## Навчальні цілі

Після завершення цього уроку ви знатимете/зрозумієте:

- **Розуміння Agentic RAG:** Дізнатись про нову парадигму в AI, де великі мовні моделі (LLM) автономно планують свої наступні кроки, витягуючи інформацію з зовнішніх джерел даних.
- **Ітеративний стиль Maker-Checker:** Осягнути концепцію циклу ітеративних викликів LLM, у який вплетені виклики інструментів або функцій та структуровані виходи, розроблений для підвищення коректності та обробки некоректних запитів.
- **Володіння процесом міркування:** Зрозуміти здатність системи володіти власним процесом міркування, приймаючи рішення про підхід до проблем без покладання на заздалегідь визначені шляхи.
- **Робочий процес:** Зрозуміти, як агентна модель самостійно вирішує отримати звіти про ринкові тенденції, ідентифікувати дані конкурентів, зіставити внутрішні показники продажів, синтезувати висновки та оцінити стратегію.
- **Ітеративні цикли, інтеграція інструментів та пам’ять:** Дізнатись про опору системи на петлевий патерн взаємодії, підтримку стану й пам’яті між кроками, щоб уникати повторних циклів і приймати обґрунтовані рішення.
- **Обробка режимів відмов та самовиправлення:** Дослідити надійні механізми самовиправлення системи, включаючи ітерації та повторні запити, використання діагностичних інструментів та повернення до людського нагляду.
- **Межі агентності:** Зрозуміти обмеження Agentic RAG, зосереджені на автономії в межах домену, залежності від інфраструктури та дотриманні обмежень.
- **Практичні випадки використання та цінність:** Визначити сценарії, де Agentic RAG демонструє переваги, такі як середовища з пріоритетом на коректність, складні взаємодії з базами даних та тривалі робочі процеси.
- **Управління, прозорість та довіра:** Дізнатись про важливість управління та прозорості, включно з пояснюваністю міркувань, контролем упереджень та людським наглядом.

## Що таке Agentic RAG?

Agentic Retrieval-Augmented Generation (Agentic RAG) — це нова парадигма в AI, у якій великі мовні моделі (LLM) не лише витягують інформацію з зовнішніх джерел даних, а й автономно планують свої наступні кроки. На відміну від статичних шаблонів «витягни — прочитай» або ретельно прописаних послідовностей підказок, Agentic RAG передбачає цикл ітеративних викликів LLM, у який вплетені виклики інструментів або функцій та структуровані результати. На кожному етапі система оцінює отримані результати, вирішує, чи уточнювати запити, за потреби викликає додаткові інструменти і продовжує цей цикл, доки не досягне задовільного рішення.

Цей ітеративний стиль «maker-checker» покликаний підвищувати коректність, обробляти некоректні запити до структурованих баз даних (наприклад, NL2SQL) і забезпечувати збалансовані, високоякісні результати. Замість того щоб покладатися виключно на ретельно спроектовані ланцюги підказок, система активно володіє своїм процесом міркування. Вона може переписувати невдалі запити, обирати інші методи витягання інформації та інтегрувати кілька інструментів — таких як векторний пошук в Azure AI Search, SQL бази даних або кастомні API — перед тим як остаточно сформулювати відповідь. Це усуває потребу в надто складних фреймворках оркестрації. Замість цього відносно проста петля «LLM виклик → використання інструменту → LLM виклик → …» може продукувати витончені та добре обґрунтовані результати.

![Agentic RAG Core Loop](../../../translated_images/uk/agentic-rag-core-loop.c8f4b85c26920f71.webp)

## Володіння процесом міркування

Відмінною рисою, що робить систему «агентною», є її здатність володіти процесом міркування. Традиційні реалізації RAG часто залежать від того, що люди заздалегідь визначають шлях для моделі: ланцюжок думок, який описує, що саме витягувати і коли.
Але коли система справді агентна, вона внутрішньо вирішує, як підійти до задачі. Вона не просто виконує скрипт; вона автономно визначає послідовність кроків на основі якості знайденої інформації.
Наприклад, якщо її просять створити стратегію запуску продукту, вона не покладається лише на підказку, яка детально описує увесь процес дослідження та прийняття рішень. Натомість агентна модель самостійно вирішує:

1. Отримати поточні звіти про ринкові тенденції за допомогою Bing Web Grounding
2. Ідентифікувати релевантні дані конкурентів за допомогою Azure AI Search.
3.	Корелювати історичні внутрішні метрики продажів за допомогою Azure SQL Database.
4.	Синтезувати висновки в цілісну стратегію, оркестровану через Azure OpenAI Service.
5.	Оцінити стратегію на наявність прогалин або несумісностей, при необхідності ініціювавши ще один раунд витягування даних.
Всі ці кроки — уточнення запитів, вибір джерел, ітерації до «задоволення» відповіді — вирішуються моделлю, а не прописуються людиною.

## Ітеративні цикли, інтеграція інструментів та пам’ять

![Tool Integration Architecture](../../../translated_images/uk/tool-integration.0f569710b5c17c10.webp)

Агентна система спирається на петлевий патерн взаємодії:

- **Початковий виклик:** Мета користувача (тобто запит користувача) подається LLM.
- **Виклик інструменту:** Якщо модель виявляє відсутню інформацію або неоднозначні інструкції, вона обирає інструмент або метод витягання — наприклад, запит до векторної бази даних (наприклад, Azure AI Search Hybrid search over private data) або структурований SQL-запит — щоб зібрати більше контексту.
- **Оцінка та уточнення:** Після перегляду повернутих даних модель вирішує, чи достатня інформація. Якщо ні, вона уточнює запит, пробує інший інструмент або змінює підхід.
- **Повторювати, доки не буде задоволено:** Цей цикл триває, доки модель не визначить, що має достатньо ясності та доказів для подачі фінальної, добре обґрунтованої відповіді.
- **Пам’ять та стан:** Оскільки система підтримує стан і пам’ять між кроками, вона може пригадувати попередні спроби та їхні результати, уникаючи повторних циклів і приймаючи більш обґрунтовані рішення в процесі.

З часом це створює відчуття еволюційного розуміння, дозволяючи моделі орієнтуватися в складних багатокрокових завданнях без потреби постійного втручання людини або переформування підказки.

## Обробка режимів відмов та самовиправлення

Автономія Agentic RAG також передбачає надійні механізми самовиправлення. Коли система доходить до глухих кутів — наприклад, витягує нерелевантні документи або стикається з некоректними запитами — вона може:

- **Ітерувати та повторно запитувати:** Замість повернення малокорисних відповідей модель пробує нові стратегії пошуку, переписує запити до баз даних або дивиться альтернативні набори даних.
- **Використовувати діагностичні інструменти:** Система може викликати додаткові функції, призначені для допомоги у налагодженні етапів мислення або підтвердженні правильності витягнутих даних. Інструменти на кшталт Azure AI Tracing будуть важливі для забезпечення надійної спостережуваності та моніторингу.
- **Покладатися на людський нагляд:** Для критичних або багаторазово збійних сценаріїв модель може позначати невпевненість і просити людської допомоги. Після того як людина надасть коригувальний зворотний зв’язок, модель може врахувати цей урок надалі.

Такий ітеративний і динамічний підхід дозволяє моделі постійно вдосконалюватися, гарантуючи, що вона не просто однократна система, а така, що вчиться на своїх помилках у рамках сесії.

![Self Correction Mechanism](../../../translated_images/uk/self-correction.da87f3783b7f174b.webp)

## Межі агентності

Незважаючи на автономність у межах завдання, Agentic RAG не є аналогом Загального штучного інтелекту. Її «агентні» можливості обмежені інструментами, джерелами даних і політиками, наданими людьми-розробниками. Вона не може винаходити власні інструменти або виходити за межі встановлених доменів. Натомість вона відмінно координує доступні ресурси в динамічному порядку.
Ключові відмінності від більш просунутих форм AI включають:

1. **Автономія у межах домену:** Системи Agentic RAG зосереджені на досягненні цілей, визначених користувачем, у відомому домені, використовуючи стратегії на кшталт переписування запитів або вибору інструментів для покращення результатів.
2. **Залежність від інфраструктури:** Можливості системи залежать від інструментів і даних, інтегрованих розробниками. Вона не може перевершити ці межі без втручання людини.
3. **Дотримання обмежень:** Етичні настанови, правила відповідності та бізнес-політики залишаються надзвичайно важливими. Свобода агента завжди обмежена заходами безпеки та механізмами нагляду (сподіваємось).

## Практичні випадки використання та цінність

Agentic RAG проявляє себе найкраще в сценаріях, що вимагають ітеративного уточнення і точності:

1. **Середовища з пріоритетом на коректність:** У перевірках на відповідність, регуляторному аналізі або юридичних дослідженнях агентна модель може багаторазово підтверджувати факти, консультуватися з кількох джерел і переписувати запити, доки не отримає ретельно перевірену відповідь.
2. **Складні взаємодії з базами даних:** Коли йдеться про структуровані дані, де запити часто можуть зазнати невдачі або потребувати коригування, система може автономно уточнювати свої запити, використовуючи Azure SQL або Microsoft Fabric OneLake, забезпечуючи, щоб фінальне витягнення відповідало наміру користувача.
3. **Тривалі робочі процеси:** Сесії, що тривають довше, можуть еволюціонувати у міру появи нової інформації. Agentic RAG може постійно інтегрувати нові дані, змінюючи стратегії у міру того, як дізнається більше про предметну область.

## Управління, прозорість та довіра

Оскільки ці системи стають більш автономними в міркуваннях, управління та прозорість набувають критичного значення:

- **Пояснюване міркування:** Модель може надавати аудиторський слід запитів, які вона робила, джерел, які вона консультувала, та кроків міркування, які вона використовувала для досягнення висновку. Інструменти на зразок Azure AI Content Safety та Azure AI Tracing / GenAIOps можуть допомогти підтримувати прозорість і зменшувати ризики.
- **Контроль упереджень і збалансований підхід до витягання:** Розробники можуть налаштовувати стратегії витягання, щоб забезпечити врахування збалансованих, репрезентативних джерел даних, і регулярно аудитувати виходи для виявлення упереджень або схильностей за допомогою кастомних моделей для просунутих data science організацій, що використовують Azure Machine Learning.
- **Людський нагляд та відповідність:** Для чутливих завдань людський перегляд залишається необхідним. Agentic RAG не замінює людське судження у рішеннях з великими ризиками — вона його підсилює, надаючи більш ретельно перевірені варіанти.

Наявність інструментів, що забезпечують чіткий запис дій, є суттєвою. Без них налагодження багатокрокового процесу може бути дуже складним. Дивіться наступний приклад від Literal AI (компанія, що стоїть за Chainlit) для запуску агента:

![Приклад запуску агента](../../../translated_images/uk/AgentRunExample.471a94bc40cbdc0c.webp)

## Висновок

Agentic RAG уособлює природну еволюцію того, як AI-системи опрацьовують складні, насичені даними завдання. Приймаючи петльовий патерн взаємодії, автономно обираючи інструменти та уточнюючи запити до досягнення високоякісного результату, система переходить від статичного слідування підказкам до більш адаптивного, контекстно-усвідомленого прийняття рішень. Хоча вона все ще обмежена інфраструктурою та етичними настановами, ці агентні можливості забезпечують багатші, динамічніші й, зрештою, корисніші AI-взаємодії як для підприємств, так і для кінцевих користувачів.

### Є ще питання про Agentic RAG?

Приєднуйтесь до [Спільноти Microsoft Foundry у Discord](https://aka.ms/ai-agents/discord), щоб зустріти інших учнів, відвідати години консультацій та отримати відповіді на свої питання щодо AI-агентів.

## Додаткові ресурси
- <a href="https://learn.microsoft.com/training/modules/use-own-data-azure-openai" target="_blank">Впровадження Retrieval Augmented Generation (RAG) з Azure OpenAI Service: Дізнайтеся, як використовувати власні дані з Azure OpenAI Service. Цей модуль Microsoft Learn надає вичерпний посібник із реалізації RAG</a>
- <a href="https://learn.microsoft.com/azure/ai-studio/concepts/evaluation-approach-gen-ai" target="_blank">Оцінка генеративних застосунків ШІ з Microsoft Foundry: У цій статті розглядається оцінювання та порівняння моделей на загальнодоступних наборах даних, включаючи агентні застосунки ШІ та архітектури RAG</a>
- <a href="https://weaviate.io/blog/what-is-agentic-rag" target="_blank">Що таке Agentic RAG | Weaviate</a>
- <a href="https://ragaboutit.com/agentic-rag-a-complete-guide-to-agent-based-retrieval-augmented-generation/" target="_blank">Agentic RAG: Повний посібник з агентно-орієнтованого Retrieval Augmented Generation – Новини від generation RAG</a>
- <a href="https://huggingface.co/learn/cookbook/agent_rag" target="_blank">Agentic RAG: підсиліть свій RAG за допомогою переформулювання запитів і self-query! Hugging Face Open-Source AI Cookbook</a>
- <a href="https://youtu.be/aQ4yQXeB1Ss?si=2HUqBzHoeB5tR04U" target="_blank">Додавання агентних шарів до RAG</a>
- <a href="https://www.youtube.com/watch?v=zeAyuLc_f3Q&t=244s" target="_blank">Майбутнє асистентів знань: Jerry Liu</a>
- <a href="https://www.youtube.com/watch?v=AOSjiXP1jmQ" target="_blank">Як побудувати системи Agentic RAG</a>
- <a href="https://ignite.microsoft.com/sessions/BRK102?source=sessions" target="_blank">Використання Microsoft Foundry Agent Service для масштабування ваших агентів ШІ</a>

### Академічні статті

- <a href="https://arxiv.org/abs/2303.17651" target="_blank">2303.17651 Self-Refine: Ітеративне вдосконалення за допомогою самозворотного зв'язку</a>
- <a href="https://arxiv.org/abs/2303.11366" target="_blank">2303.11366 Reflexion: Мовні агенти з вербальним підкріплювальним навчанням</a>
- <a href="https://arxiv.org/abs/2305.11738" target="_blank">2305.11738 CRITIC: Великі мовні моделі можуть самостійно виправлятися за допомогою інтерактивної критики з інструментами</a>
- <a href="https://arxiv.org/abs/2501.09136" target="_blank">2501.09136 Agentic Retrieval-Augmented Generation: Огляд Agentic RAG</a>

## Попередній урок

[Патерн використання інструментів](../04-tool-use/README.md)

## Наступний урок

[Побудова надійних агентів ШІ](../06-building-trustworthy-agents/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
Відмова від відповідальності:
Цей документ було перекладено за допомогою сервісу перекладу на основі штучного інтелекту [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, просимо зауважити, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ мовою оригіналу слід вважати авторитетним джерелом. Для критично важливої інформації рекомендується звертатися до професійного перекладу, виконаного людиною. Ми не несемо відповідальності за будь-які непорозуміння чи неправильні тлумачення, що виникли внаслідок використання цього перекладу.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->