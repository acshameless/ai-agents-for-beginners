[![Дизайн багатоагентної системи](../../../translated_images/uk/lesson-8-thumbnail.278a3e4a59137d62.webp)](https://youtu.be/V6HpE9hZEx0?si=A7K44uMCqgvLQVCa)

> _(Клацніть зображення вище, щоб переглянути відео цього уроку)_

# Патерни проєктування для багатоагентних систем

Як тільки ви починаєте працювати над проєктом, що включає кілька агентів, потрібно розглянути патерн проєктування багатоагентної системи. Проте може бути не одразу зрозуміло, коли переходити на багатоагентну архітектуру і які в ній переваги.

## Вступ

У цьому уроці ми прагнемо відповісти на такі питання:

- У яких сценаріях застосовні багатоагентні системи?
- Які переваги використання кількох агентів замість одного агента, що виконує кілька завдань?
- Які будівельні блоки реалізації патерну багатоагентного проєктування?
- Як мати видимість того, як кілька агентів взаємодіють один з одним?

## Навчальні цілі

Після цього уроку ви повинні вміти:

- Визначати сценарії, де застосовні багатоагентні системи
- Розпізнавати переваги використання кількох агентів над одиничним агентом
- Розуміти будівельні блоки реалізації патерну багатоагентного проєктування

Яка загальна картина?

*Багатоагентні системи — це патерн проєктування, що дозволяє кільком агентам працювати разом для досягнення спільної мети*.

Цей патерн широко використовується в різних галузях, включаючи робототехніку, автономні системи та розподілені обчислення.

## Сценарії, де застосовні багатоагентні системи

Отже, які сценарії є хорошими випадками для використання багатоагентних систем? Відповідь у тому, що є багато сценаріїв, де найкраще застосовувати кілька агентів, особливо в таких випадках:

- **Великі навантаження**: великі навантаження можна розділити на дрібніші завдання та призначити різним агентам, що дозволяє паралельну обробку і швидше виконання. Прикладом цього є обробка великих обсягів даних.
- **Складні завдання**: складні завдання, як і великі навантаження, можна розбити на підзадачі та призначити різним агентам, кожен з яких спеціалізується на певному аспекті завдання. Хорошим прикладом є автономні транспортні засоби, де різні агенти керують навігацією, виявленням перешкод і зв'язком з іншими транспортними засобами.
- **Різноманітна експертиза**: різні агенти можуть мати різну експертизу, що дозволяє їм ефективніше обробляти різні аспекти завдання, ніж один агент. У цьому випадку гарним прикладом є охорона здоров'я, де агенти можуть займатися діагностикою, планами лікування та моніторингом пацієнтів.

## Переваги використання кількох агентів замість одиничного агента

Система з одним агентом може добре працювати для простих завдань, але для складніших завдань використання кількох агентів дає кілька переваг:

- **Спеціалізація**: кожен агент може спеціалізуватися на конкретному завданні. Відсутність спеціалізації в одному агенті означає, що у вас є агент, який може робити все, але може заплутатися, що робити при зіткненні зі складним завданням. Наприклад, він може в кінцевому підсумку виконати завдання, для якого не найбільш придатний.
- **Масштабованість**: легше масштабувати систему, додаючи більше агентів, ніж перевантажувати один агент.
- **Відмовостійкість**: якщо один агент виходить з ладу, інші можуть продовжити роботу, забезпечуючи надійність системи.

Розгляньмо приклад: забронюємо поїздку для користувача. Система з одним агентом мала б обробляти всі аспекти процесу бронювання поїздки — від пошуку авіарейсів до бронювання готелів і оренди автомобілів. Щоб досягти цього з одним агентом, агент повинен мати інструменти для обробки всіх цих завдань. Це може призвести до складної та монолітної системи, яку важко підтримувати та масштабувати. Багатоагентна система, навпаки, може мати різних агентів, спеціалізованих на пошуку рейсів, бронюванні готелів та оренді авто. Це зробить систему модульнішою, простішою у підтримці та масштабуванні.

Порівняйте це з туристичним бюро, що працює як крамниця сімейного бізнесу проти мережевого франчайзингу. У сімейній крамниці один агент обробляє всі аспекти бронювання, тоді як у франшизі різні агенти відповідають за різні аспекти процесу.

## Будівельні блоки реалізації патерну багатоагентного проєктування

Перш ніж реалізовувати патерн багатоагентного проєктування, треба зрозуміти будівельні блоки, які його складають.

Зробімо це більш конкретним, знову розглянувши приклад бронювання поїздки для користувача. У цьому випадку будівельні блоки включають:

- **Agent Communication**: Агенти, що шукають рейси, бронюють готелі та оренду авто, повинні спілкуватися та ділитися інформацією про вподобання та обмеження користувача. Потрібно вирішити протоколи та методи для такої комунікації. Конкретно це означає, що агент з пошуку рейсів повинен спілкуватися з агентом бронювання готелів, щоб упевнитися, що готель заброньовано на ті ж дати, що й рейс. Тобто агенти повинні обмінюватися інформацією про дати подорожі користувача, отже треба вирішити *які агенти діляться інформацією і як вони її обмінюються*.
- **Coordination Mechanisms**: Агенти повинні координувати свої дії, щоб упевнитися, що вподобання та обмеження користувача задовольняються. Вподобання користувача можуть бути, наприклад, бажання готелю поруч з аеропортом, тоді як обмеження можуть стосуватися того, що оренда авто доступна лише в аеропорту. Це означає, що агент бронювання готелів має координуватися з агентом оренди авто, щоб переконатися, що вподобання та обмеження користувача дотримано. Потрібно вирішити *як агенти координують свої дії*.
- **Agent Architecture**: Агенти повинні мати внутрішню структуру для прийняття рішень і навчання на основі взаємодій з користувачем. Це означає, що агент пошуку рейсів має мати внутрішню структуру для прийняття рішень про те, які рейси рекомендувати користувачу. Потрібно вирішити *як агенти приймають рішення і навчаються на взаємодіях з користувачем*. Прикладами навчання агента можуть бути випадки, коли агент пошуку рейсів використовує модель машинного навчання для рекомендацій рейсів користувачу на основі його попередніх вподобань.
- **Visibility into Multi-Agent Interactions**: Потрібно мати видимість того, як кілька агентів взаємодіють між собою. Це означає, що потрібні інструменти та методики для відстеження активностей та взаємодій агентів. Це може бути у вигляді засобів логування та моніторингу, інструментів візуалізації та метрик продуктивності.
- **Multi-Agent Patterns**: Існують різні патерни реалізації багатоагентних систем, такі як централізовані, децентралізовані та гібридні архітектури. Слід вибрати патерн, який найкраще підходить для вашого випадку використання.
- **Human in the loop**: У більшості випадків у процесі бере участь людина, і потрібно вказати агентам, коли просити втручання людини. Це може бути у вигляді запиту користувача на конкретний готель або рейс, які агенти не рекомендували, або запиту на підтвердження перед бронюванням рейсу чи готелю.

## Видимість взаємодій багатоагентної системи

Важливо мати видимість того, як кілька агентів взаємодіють між собою. Ця видимість необхідна для налагодження, оптимізації та забезпечення загальної ефективності системи. Для цього потрібно мати інструменти та підходи для відстеження дій та взаємодій агентів. Це може бути у вигляді засобів логування та моніторингу, інструментів візуалізації та метрик продуктивності.

Наприклад, у випадку бронювання поїздки для користувача можна мати панель керування, яка показує стан кожного агента, вподобання та обмеження користувача та взаємодії між агентами. Ця панель може показувати дати подорожі користувача, рейси, рекомендовані агентом з пошуку рейсів, готелі, рекомендовані агентом готелів, та орендні авто, рекомендовані агентом з оренди авто. Це дасть чітке уявлення про те, як агенти взаємодіють між собою і чи задовольняються вподобання та обмеження користувача.

Розглянемо кожен з цих аспектів детальніше.

- **Logging and Monitoring Tools**: Ви маєте вести логування для кожної дії, виконаної агентом. Запис у журналі може зберігати інформацію про агента, що виконав дію, саму дію, час її виконання та результат дії. Цю інформацію потім можна використовувати для налагодження, оптимізації та інших цілей.
- **Visualization Tools**: Інструменти візуалізації допомагають бачити взаємодії між агентами більш інтуїтивно. Наприклад, можна мати граф, що показує потік інформації між агентами. Це може допомогти виявити вузькі місця, неефективності та інші проблеми в системі.
- **Performance Metrics**: Метрики продуктивності допомагають відстежувати ефективність багатоагентної системи. Наприклад, можна відстежувати час, необхідний для виконання завдання, кількість завдань, виконаних за одиницю часу, та точність рекомендацій, зроблених агентами. Ця інформація допоможе визначити області для покращення та оптимізувати систему.

## Патерни багатоагентних систем

Розберімося з деякими конкретними патернами, які можна використати для створення багатоагентних додатків. Ось кілька цікавих патернів, які варто розглянути:

### Груповий чат

Цей патерн корисний, коли ви хочете створити додаток для групового чату, в якому кілька агентів можуть спілкуватися один з одним. Типові випадки використання цього патерну включають командну співпрацю, підтримку клієнтів та соціальні мережі.

У цьому патерні кожен агент представляє користувача в груповому чаті, а повідомлення обмінюються між агентами за допомогою протоколу обміну повідомленнями. Агенти можуть надсилати повідомлення в груповий чат, отримувати повідомлення з групового чату та відповідати на повідомлення інших агентів.

Цей патерн можна реалізувати за допомогою централізованої архітектури, де всі повідомлення маршрутизуються через центральний сервер, або децентралізованої архітектури, де повідомлення обмінюються безпосередньо.

![Груповий чат](../../../translated_images/uk/multi-agent-group-chat.ec10f4cde556babd.webp)

### Передача завдання

Цей патерн корисний, коли ви хочете створити додаток, де кілька агентів можуть передавати завдання один одному.

Типові сценарії використання цього патерну включають підтримку клієнтів, управління завданнями та автоматизацію робочих процесів.

У цьому патерні кожен агент представляє завдання або крок у робочому процесі, і агенти можуть передавати завдання іншим агентам на основі попередньо визначених правил.

![Передача завдання](../../../translated_images/uk/multi-agent-hand-off.4c5fb00ba6f8750a.webp)

### Спільна фільтрація

Цей патерн корисний, коли ви хочете створити додаток, де кілька агентів можуть співпрацювати, щоб робити рекомендації для користувачів.

Причина, чому варто, щоб кілька агентів співпрацювали, полягає в тому, що кожен агент може мати різну експертизу і може вносити різний вклад у процес рекомендацій.

Розгляньмо приклад, де користувач хоче отримати рекомендацію щодо найкращої акції для купівлі на фондовому ринку.

- **Industry expert**:. Один агент може бути експертом у певній галузі.
- **Technical analysis**: Інший агент може бути експертом у технічному аналізі.
- **Fundamental analysis**: І ще один агент може бути експертом у фундаментальному аналізі. Співпрацюючи, ці агенти можуть надати користувачеві більш ґрунтовну рекомендацію.

![Рекомендація](../../../translated_images/uk/multi-agent-filtering.d959cb129dc9f608.webp)

## Сценарій: процес повернення коштів

Розглянемо сценарій, коли клієнт намагається отримати повернення коштів за продукт — у цьому процесі може бути задіяно багато агентів, але розділимо їх на агентів, специфічних для цього процесу, та загальних агентів, які можна використовувати в інших процесах.

**Агенти, специфічні для процесу повернення коштів**:

Нижче наведено деякі агенти, які можуть бути задіяні в процесі повернення коштів:

- **Customer agent**: Цей агент представляє клієнта і відповідає за ініціювання процесу повернення коштів.
- **Seller agent**: Цей агент представляє продавця і відповідає за обробку повернення коштів.
- **Payment agent**: Цей агент представляє платіжний процес і відповідає за відшкодування платежу клієнта.
- **Resolution agent**: Цей агент представляє процес вирішення спорів і відповідає за вирішення будь-яких проблем, що виникають під час процесу повернення коштів.
- **Compliance agent**: Цей агент представляє процес відповідності вимогам і відповідає за забезпечення того, щоб процес повернення коштів відповідав правилам та політикам.

**Загальні агенти**:

Ці агенти можна використовувати в інших частинах бізнесу.

- **Shipping agent**: Цей агент представляє процес доставки і відповідає за відправлення продукту назад продавцю. Цього агента можна використовувати як для процесу повернення коштів, так і для загальної доставки продукту при купівлі.
- **Feedback agent**: Цей агент представляє процес збору відгуків і відповідає за збір зворотного зв'язку від клієнта. Збір відгуків може відбуватися у будь-який час, а не лише під час процесу повернення коштів.
- **Escalation agent**: Цей агент представляє процес ескалації і відповідає за передачу проблем на вищий рівень підтримки. Такий тип агента можна використовувати в будь-якому процесі, де потрібно ескалувати проблему.
- **Notification agent**: Цей агент представляє процес сповіщень і відповідає за надсилання повідомлень клієнту на різних етапах процесу повернення коштів.
- **Analytics agent**: Цей агент представляє процес аналітики і відповідає за аналіз даних, пов'язаних із процесом повернення коштів.
- **Audit agent**: Цей агент представляє процес аудиту і відповідає за перевірку процесу повернення коштів, щоб упевнитися, що він виконується правильно.
- **Reporting agent**: Цей агент представляє процес звітності і відповідає за формування звітів щодо процесу повернення коштів.
- **Knowledge agent**: Цей агент представляє процес управління знаннями і відповідає за підтримку бази знань щодо інформації, пов'язаної з процесом повернення коштів. Цей агент може бути обізнаним як щодо повернень, так і щодо інших частин вашого бізнесу.
- **Security agent**: Цей агент представляє процес безпеки і відповідає за забезпечення безпеки процесу повернення коштів.
- **Quality agent**: Цей агент представляє процес контролю якості і відповідає за забезпечення якості процесу повернення коштів.

Було наведено досить багато агентів як для специфічного процесу повернення коштів, так і для загальних агентів, яких можна використати в інших частинах вашого бізнесу. Сподіваюся, це дає уявлення про те, як можна вирішувати, які агенти використовувати у вашій багатоагентній системі.

## Завдання

Спроєктуйте багатоагентну систему для процесу підтримки клієнтів. Визначте агентів, задіяних у процесі, їхні ролі та обов'язки, а також як вони взаємодіють один з одним. Розгляньте як агенти, специфічні для процесу підтримки клієнтів, так і загальні агенти, яких можна використовувати в інших частинах вашого бізнесу.
> Подумайте перед тим, як читати наступне рішення — вам може знадобитися більше агентів, ніж ви думаєте.
 
> ПОРАДА: Подумайте про різні етапи процесу підтримки клієнтів і також врахуйте агентів, необхідних для будь-якої системи.
 
## Solution
 
[Рішення](./solution/solution.md)
 
## Knowledge checks
 
Question: When should you consider using multi-agents?
 
- [ ] A1: Коли у вас невелике навантаження та проста задача.
- [ ] A2: Коли у вас велике навантаження
- [ ] A3: Коли у вас проста задача.
 
[Solution quiz](./solution/solution-quiz.md)
 
## Summary
 
In this lesson, we've looked at the multi-agent design pattern, including the scenarios where multi-agents are applicable, the advantages of using multi-agents over a singular agent, the building blocks of implementing the multi-agent design pattern, and how to have visibility into how the multiple agents are interacting with each other.
 
### Got More Questions about the Multi-Agent Design Pattern?
 
Join the [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord) to meet with other learners, attend office hours and get your AI Agents questions answered.
 
## Additional resources
 
- <a href="https://microsoft.github.io/autogen/stable/user-guide/core-user-guide/design-patterns/intro.html" target="_blank">Шаблони проектування AutoGen</a>
- <a href="https://www.analyticsvidhya.com/blog/2024/10/agentic-design-patterns/" target="_blank">Агентні шаблони проектування</a>
 
 
## Previous Lesson
 
[Планування дизайну](../07-planning-design/README.md)
 
## Next Lesson
 
[Метакогніція в агентах ШІ](../09-metacognition/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
Відмова від відповідальності:
Цей документ було перекладено за допомогою сервісу машинного перекладу на базі штучного інтелекту Co-op Translator (https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, зверніть увагу, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ рідною мовою слід вважати авторитетним джерелом. Для критично важливої інформації рекомендується скористатися послугами професійного перекладача. Ми не несемо відповідальності за будь-які непорозуміння або хибні тлумачення, що виникли внаслідок використання цього перекладу.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->