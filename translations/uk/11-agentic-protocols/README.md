# Використання агентних протоколів (MCP, A2A і NLWeb)

[![Agentic Protocols](../../../translated_images/uk/lesson-11-thumbnail.b6c742949cf1ce2a.webp)](https://youtu.be/X-Dh9R3Opn8)

> _(Натисніть на зображення зверху, щоб переглянути відео цього уроку)_

Зі зростанням використання AI агентів зростає і потреба в протоколах, які забезпечують стандартизацію, безпеку та підтримують відкриті інновації. У цьому уроці ми розглянемо 3 протоколи, які спрямовані на задоволення цієї потреби – Model Context Protocol (MCP), Agent to Agent (A2A) та Natural Language Web (NLWeb).

## Вступ

У цьому уроці ми розглянемо:

• Як **MCP** дозволяє AI агентам отримувати доступ до зовнішніх інструментів і даних для виконання завдань користувача.

• Як **A2A** забезпечує комунікацію та співпрацю між різними AI агентами.

• Як **NLWeb** приводить інтерфейси природної мови на будь-який вебсайт, дозволяючи AI агентам знаходити та взаємодіяти з контентом.

## Цілі навчання

• **Визначити** основну мету та переваги MCP, A2A і NLWeb у контексті AI агентів.

• **Пояснити**, як кожен протокол сприяє комунікації та взаємодії між LLM, інструментами та іншими агентами.

• **Визнати** унікальні ролі кожного протоколу в побудові складних агентних систем.

## Протокол Model Context

**Model Context Protocol (MCP)** — це відкритий стандарт, який надає стандартизований спосіб для додатків надавати контекст і інструменти LLM. Це дає змогу створити "універсальний адаптер" до різних джерел даних і інструментів, до яких AI агенти можуть підключатися послідовно.

Розглянемо компоненти MCP, переваги в порівнянні з прямим використанням API та приклад того, як AI агенти можуть використовувати MCP сервер.

### Основні компоненти MCP

MCP працює на основі **клієнт-серверної архітектури**, основні компоненти такі:

• **Хости** — це LLM-додатки (наприклад, редактор коду VSCode), які ініціюють підключення до MCP сервера.

• **Клієнти** — компоненти всередині хост-додатку, які підтримують одно-до-одного зв’язки з серверами.

• **Сервери** — легкі програми, які надають конкретні можливості.

До протоколу входять три основні примітиви, які визначають можливості MCP сервера:

• **Інструменти**: це окремі дії або функції, які AI агент може викликати для виконання дії. Наприклад, сервіс погоди може надавати інструмент "отримати погоду", або e-commerce сервер — інструмент "придбати товар". MCP сервери передають ім'я інструменту, опис і схему вводу/виводу у списку своїх можливостей.

• **Ресурси**: це лише для читання елементи даних або документи, які MCP сервер може надавати, а клієнти можуть отримувати їх на вимогу. Приклади: вміст файлів, записи бази даних або журнальні файли. Ресурси можуть бути текстовими (код або JSON) або бінарними (зображення або PDF).

• **Підказки**: це заздалегідь визначені шаблони, які пропонують рекомендовані запити, дозволяючи створювати складніші робочі процеси.

### Переваги MCP

MCP надає значні переваги для AI агентів:

• **Динамічне виявлення інструментів**: агенти можуть динамічно отримувати список доступних інструментів від сервера разом із описами їх роботи. Це відрізняється від традиційних API, які часто потребують статичного кодування інтеграцій, тож будь-яка зміна API вимагає оновлення коду. MCP дає підхід «інтегрувати один раз», що забезпечує гнучкість.

• **Інтероперабельність між LLM**: MCP працює з різними LLM, надаючи свободу змінювати основні моделі для кращої продуктивності.

• **Стандартизована безпека**: MCP включає стандартний метод автентифікації, що покращує масштабованість при додаванні доступу до інших MCP серверів. Це простіше, ніж керування різними ключами та типами автентифікації різних традиційних API.

### Приклад MCP

![MCP Diagram](../../../translated_images/uk/mcp-diagram.e4ca1cbd551444a1.webp)

Уявімо, що користувач хоче забронювати рейс за допомогою AI асистента на базі MCP.

1. **Підключення**: AI асистент (MCP клієнт) підключається до MCP сервера, який надає авіакомпанія.

2. **Виявлення інструментів**: клієнт запитує MCP сервер авіакомпанії: "Які інструменти у вас доступні?" Сервер відповідає з інструментами, як-от "пошук рейсів" і "бронювання рейсів".

3. **Виклик інструменту**: користувач каже AI асистенту: "Будь ласка, знайди рейс з Портленда до Гонолулу." AI асистент із своїм LLM розуміє, що потрібно викликати інструмент "пошук рейсів" і передає відповідні параметри (пункт відправлення, пункт призначення) MCP серверу.

4. **Виконання та відповідь**: MCP сервер, виконуючи роль обгортки, робить фактичний виклик внутрішнього API бронювання авіакомпанії. Потім він отримує інформацію про рейси (наприклад, дані JSON) і надсилає її назад AI асистенту.

5. **Подальша взаємодія**: AI асистент показує варіанти рейсів. Після вибору вами рейсу асистент може викликати інструмент "забронювати рейс" на тому ж MCP сервері, завершуючи бронювання.

## Протокол агент до агента (A2A)

Якщо MCP фокусується на підключенні LLM до інструментів, то **Agent-to-Agent (A2A) протокол** виходить на крок далі, забезпечуючи комунікацію та співпрацю між різними AI агентами. A2A з’єднує AI агентів з різних організацій, середовищ і технологічних стеків для спільного виконання завдання.

Розглянемо компоненти та переваги A2A, а також приклад застосування у нашому додатку для подорожей.

### Основні компоненти A2A

A2A зосереджений на комунікації між агентами та їхній співпраці для виконання підзавдань користувача. Кожен компонент протоколу цьому сприяє:

#### Agent Card

Подібно до того, як MCP сервер надає список інструментів, Agent Card містить:
- Ім'я агента.
- **Опис загальних завдань**, які він виконує.
- **Список конкретних навичок** з описами, які допомагають іншим агентам (або навіть користувачам) зрозуміти, коли і навіщо звертатись до цього агента.
- **Поточна URL-адреса Endpoint** агента.
- **Версія** та **можливості** агента, такі як стрімінг відповідей і пуш-повідомлення.

#### Agent Executor

Agent Executor відповідає за **передачу контексту чату користувача віддаленому агенту**, який потребує цієї інформації для розуміння завдання. В A2A сервері агент використовує власний Великий Мовний Модель (LLM) для парсингу вхідних запитів і виконання завдань за допомогою власних внутрішніх інструментів.

#### Артефакт

Після завершення завдання віддаленим агентом створюється артефакт. Артефакт **містить результат роботи агента**, **опис того, що було виконано**, та **текстовий контекст**, який передається через протокол. Після відправлення артефакту з’єднання з віддаленим агентом закривається до наступної потреби.

#### Черга подій

Цей компонент використовується для **обробки оновлень і передачі повідомлень**. Особливо важливий у продакшені для агентних систем, щоб уникнути закриття з’єднання між агентами до завершення завдання, особливо якщо виконання може займати тривалий час.

### Переваги A2A

• **Покращена співпраця**: дозволяє агентам від різних постачальників і платформ взаємодіяти, ділитися контекстом і спільно працювати, сприяючи безшовній автоматизації між традиційно роз’єднаними системами.

• **Гнучкість вибору моделі**: кожен A2A агент може обирати свій LLM для обробки запитів, дозволяючи оптимізовані або тонко налаштовані моделі на агента, на відміну від одного LLM підключення в деяких випадках MCP.

• **Вбудована автентифікація**: автентифікація інтегрована безпосередньо в протокол A2A, забезпечуючи надійну систему безпеки для взаємодії агентів.

### Приклад A2A

![A2A Diagram](../../../translated_images/uk/A2A-Diagram.8666928d648acc26.webp)

Розглянемо нашу ситуацію з бронюванням подорожі, але цього разу з використанням A2A.

1. **Запит користувача до мультиагента**: користувач спілкується з клієнтом/агентом A2A "Туристичний агент", наприклад: "Будь ласка, забронюй повну поїздку до Гонолулу на наступний тиждень, включно з квитками, готелем і прокатом авто."

2. **Оркестрація Туристичним агентом**: Туристичний агент отримує це складне завдання. Він використовує свій LLM, щоб розібратися у завданні й визначити, що потрібно взаємодіяти з іншими спеціалізованими агентами.

3. **Взаємодія між агентами**: Туристичний агент за допомогою протоколу A2A підключається до інших агентів, як-от "Авіакомпанія", "Готель" і "Прокат авто" від різних компаній.

4. **Делегування завдань**: Туристичний агент надсилає специфічні завдання цим спеціалізованим агентам (наприклад, "Знайти рейси до Гонолулу", "Забронювати готель", "Взяти авто в прокат"). Кожен із спеціалізованих агентів, керуючись своїм LLM і власними інструментами (які можуть бути MCP серверами), виконує свою частину бронювання.

5. **Об’єднана відповідь**: після того, як усі агенти завершують свої завдання, Туристичний агент збирає результати (деталі рейсів, підтвердження готелю, бронь авто) і надсилає комплексну відповідь у чаті користувачу.

## Natural Language Web (NLWeb)

Вебсайти давно є основним способом для користувачів доступатися до інформації і даних в інтернеті.

Розглянемо різні компоненти NLWeb, його переваги та приклад роботи NLWeb на прикладі нашого додатку для подорожей.

### Компоненти NLWeb

- **NLWeb Application (Основний сервісний код)**: система, яка обробляє запити природною мовою. Вона поєднує різні частини платформи для створення відповідей. Можна уявити її як **двигун, що керує функціями природної мови** на вебсайті.

- **Протокол NLWeb**: це **базовий набір правил для взаємодії природною мовою** з вебсайтом. Він повертає відповіді у форматі JSON (часто використовуючи Schema.org). Мета – створити просту основу для "AI Web" так само, як HTML зробив можливим обмін документами онлайн.

- **MCP Server (Model Context Protocol Endpoint)**: кожен NLWeb набір також працює як **MCP сервер**. Це означає, що він може **поширювати інструменти (наприклад, метод "ask") і дані** з іншими AI системами. Практично це робить контент і можливості сайту доступними для AI агентів, дозволяючи сайту стати частиною ширшої "агентної екосистеми".

- **Embedding Models**: ці моделі використовуються для **перетворення контенту сайту у цифрові представлення, звані векторами (embedding)**. Вектори захоплюють зміст у спосіб, який комп’ютери можуть порівнювати та шукати. Вони зберігаються у спеціальній базі даних, і користувачі можуть обирати, яку embedding модель використовувати.

- **Vector Database (Механізм пошуку)**: ця база даних **зберігає embeddings контенту сайту**. Коли користувач ставить запитання, NLWeb перевіряє векторну базу, щоб швидко знайти найбільш релевантну інформацію. Вона повертає швидкий список можливих відповідей, відсортованих за схожістю. NLWeb сумісний з різними системами зберігання векторів, такими як Qdrant, Snowflake, Milvus, Azure AI Search та Elasticsearch.

### NLWeb на прикладі

![NLWeb](../../../translated_images/uk/nlweb-diagram.c1e2390b310e5fe4.webp)

Розглянемо наш сайт бронювання подорожей, але тепер на основі NLWeb.

1. **Завантаження даних**: існуючі каталоги продуктів сайту (наприклад, списки рейсів, описи готелів, турпакети) форматуються за стандартом Schema.org або завантажуються через RSS фіди. Інструменти NLWeb приймають цю структуровану інформацію, створюють embeddings і зберігають їх у локальній або віддаленій векторній базі.

2. **Запит природною мовою (людина)**: користувач заходить на сайт і замість навігації меню вводить у чат: "Знайди мені сімейний готель у Гонолулу з басейном на наступний тиждень".

3. **Обробка NLWeb**: застосунок NLWeb отримує цей запит. Він надсилає запит LLM для розуміння і одночасно шукає у векторній базі відповідні пропозиції готелів.

4. **Точні результати**: LLM допомагає інтерпретувати результати пошуку з бази, визначає найкращі збіги за критеріями "сімейний", "басейн" і "Гонолулу", а потім форматує відповідь природною мовою. Важливо, що відповідь посилається на реальні готелі з каталогу сайту, без вигадок.

5. **Взаємодія AI агента**: оскільки NLWeb виступає MCP сервером, зовнішній AI агент подорожей також може підключитися до NLWeb цього сайту. AI агент може використати метод `ask` MCP для безпосереднього запиту сайту: `ask("Чи є у районі Гонолулу веганські ресторани, рекомендовані готелем?")`. NLWeb обробить цей запит, скориставшись своєю базою даних про ресторани (якщо вона завантажена), і поверне структуровану JSON відповідь.

### Маєте більше питань про MCP/A2A/NLWeb?

Приєднуйтесь до [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord), щоб поспілкуватися з іншими учнями, відвідати офіс-години та отримати відповіді на ваші запитання щодо AI агентів.

## Ресурси

- [MCP для початківців](https://aka.ms/mcp-for-beginners)  
- [Документація MCP](https://github.com/microsoft/semantic-kernel/tree/main/python/semantic-kernel/semantic_kernel/connectors/mcp)
- [Репозиторій NLWeb](https://github.com/nlweb-ai/NLWeb)
- [Керівництва Semantic Kernel](https://learn.microsoft.com/semantic-kernel/)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Відмова від відповідальності**:
Цей документ було перекладено за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ його рідною мовою слід вважати авторитетним джерелом. Для критичної інформації рекомендується звертатися до професійного людського перекладу. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникли внаслідок використання цього перекладу.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->