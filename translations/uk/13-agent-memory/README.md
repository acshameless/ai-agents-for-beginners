# Пам’ять для AI Агентів  
[![Agent Memory](../../../translated_images/uk/lesson-13-thumbnail.959e3bc52d210c64.webp)](https://youtu.be/QrYbHesIxpw?si=qNYW6PL3fb3lTPMk)

При обговоренні унікальних переваг створення AI Агентів здебільшого говорять про дві речі: здатність викликати інструменти для виконання завдань і здатність покращуватися з часом. Пам'ять лежить у основі створення агента з самовдосконаленням, який може створювати кращий досвід для наших користувачів.

У цьому уроці ми розглянемо, що таке пам’ять для AI Агентів і як ми можемо її управляти та використовувати на користь наших застосунків.

## Вступ

У цьому уроці ми охопимо:

• **Розуміння пам’яті AI агента**: Що таке пам’ять і чому вона важлива для агентів.

• **Впровадження та зберігання пам’яті**: Практичні методи додавання пам’яті до AI агентів, зосереджені на короткостроковій та довгостроковій пам’яті.

• **Зробити AI агентів здатними до самовдосконалення**: Як пам’ять дозволяє агентам вчитися на минулих взаємодіях і покращуватися з часом.

## Доступні реалізації

Цей урок включає два комплексні ноутбуки-інструкції:

• **[13-agent-memory.ipynb](./13-agent-memory.ipynb)**: Реалізує пам’ять за допомогою Mem0 та Azure AI Search з використанням Semantic Kernel framework

• **[13-agent-memory-cognee.ipynb](./13-agent-memory-cognee.ipynb)**: Реалізує структуровану пам’ять за допомогою Cognee, автоматично створюючи граф знань на основі ембеддингів, візуалізуючи граф та забезпечуючи інтелектуальний пошук

## Цілі навчання

Після завершення цього уроку ви знатимете, як:

• **Відрізняти різні типи пам’яті AI агента**, включаючи робочу, короткострокову та довгострокову пам’ять, а також спеціалізовані форми, такі як пам’ять персонажа та епізодична пам’ять.

• **Впроваджувати та керувати короткостроковою і довгостроковою пам’яттю AI агентів** за допомогою Semantic Kernel framework, використовуючи інструменти як Mem0, Cognee, Whiteboard memory та інтегруючи з Azure AI Search.

• **Розуміти принципи самовдосконалення AI агентів** та роль надійних систем управління пам’яттю для безперервного навчання й адаптації.

## Розуміння пам’яті AI агента

По суті, **пам’ять для AI агентів — це механізми, які дозволяють їм зберігати і згадувати інформацію**. Ця інформація може містити конкретні деталі розмови, вподобання користувача, минулі дії чи навіть вивчені шаблони.

Без пам’яті AI застосунки часто є безстанними, тобто кожна взаємодія починається з нуля. Це призводить до повторюваного та фрустрованого користувацького досвіду, коли агент "забуває" попередній контекст або вподобання.

### Чому пам’ять важлива?

Інтелект агента глибоко пов’язаний із його здатністю згадувати і використовувати минулу інформацію. Пам’ять дозволяє агентам бути:

• **Рефлексивними**: Вчитися на минулих діях та їх результатах.

• **Інтерактивними**: Підтримувати контекст під час тривалої розмови.

• **Проактивними та реактивними**: Передбачати потреби або відповідати відповідно до історичних даних.

• **Автономними**: Працювати більш незалежно, спираючись на збережені знання.

Мета впровадження пам’яті — зробити агентів більш **надійними та здібними**.

### Типи пам’яті

#### Робоча пам’ять

Уявіть собі це як аркуш для заміток, який агент використовує під час одного поточного завдання або процесу мислення. Вона зберігає негайну інформацію, необхідну для обчислення наступного кроку.

Для AI агентів робоча пам’ять часто фіксує найрелевантнішу інформацію з розмови, навіть якщо повна історія чату довга або обрізана. Вона зосереджена на виділенні ключових елементів, таких як вимоги, пропозиції, рішення та дії.

**Приклад робочої пам’яті**

У агента з бронювання подорожей робоча пам’ять може захоплювати поточний запит користувача, наприклад "Я хочу забронювати поїздку до Парижа". Ця конкретна вимога утримується в негайному контексті агента, щоб направляти поточну взаємодію.

#### Короткострокова пам’ять

Цей тип пам’яті зберігає інформацію протягом однієї розмови або сесії. Це контекст поточного чату, що дозволяє агенту посилатися на попередні відповіді в діалозі.

**Приклад короткострокової пам’яті**

Якщо користувач запитує: «Скільки коштує політ до Парижа?» а потім продовжує «А як щодо проживання там?», короткострокова пам’ять гарантує, що агент розуміє, що «там» стосується «Парижу» в рамках тої ж розмови.

#### Довгострокова пам’ять

Це інформація, яка зберігається між кількома розмовами або сесіями. Вона дозволяє агентам пам’ятати вподобання користувачів, історію взаємодій або загальні знання протягом тривалого часу. Це важливо для персоналізації.

**Приклад довгострокової пам’яті**

Довгострокова пам’ять може зберігати інформацію, що «Бен любить лижі та активний відпочинок на природі, смакує каву з видом на гори, і уникає складних трас через минулу травму». Ця інформація, вивчена під час попередніх взаємодій, впливає на рекомендації у майбутніх сесіях планування подорожей, роблячи їх максимально персоналізованими.

#### Пам’ять персонажа

Цей спеціалізований тип пам’яті допомагає агенту розвинути послідовний «характер» або «персону». Вона дозволяє агенту пам’ятати деталі про себе або свою роль, що робить взаємодії більш плавними і цілеспрямованими.

**Приклад пам’яті персонажа**  
Якщо агент з подорожей розроблений як «експерт зі сноубордингу», пам’ять персонажа може підсилювати цю роль, впливаючи на його відповіді, щоб відповідати тону і знанням експерта.

#### Робочий процес / Епізодична пам’ять

Ця пам’ять зберігає послідовність кроків, які агент виконує під час складного завдання, включно з успіхами і невдачами. Це схоже на пам’ять конкретних «епізодів» або минулого досвіду для навчання.

**Приклад епізодичної пам’яті**

Якщо агент намагався забронювати конкретний рейс, але це не вдалося через відсутність місць, епізодична пам’ять може зафіксувати цей провал, даючи агенту змогу спробувати альтернативні варіанти або краще інформувати користувача про проблему при наступних спробах.

#### Пам’ять сутностей

Це процес витягання та запам’ятовування конкретних сутностей (як люди, місця або речі) і подій із розмов. Це дозволяє агенту будувати структуроване розуміння ключових обговорюваних елементів.

**Приклад пам’яті сутностей**

У розмові про минулу поїздку агент може виділити сутності: «Париж», «Ейфелева вежа» та «вечеря в ресторані Le Chat Noir». У майбутній взаємодії агент зможе згадати «Le Chat Noir» і запропонувати зробити нове бронювання там.

#### Структурований RAG (Retrieval Augmented Generation)

Хоча RAG — це ширша методика, «Структурований RAG» виокремлюється як потужна технологія пам’яті. Вона витягає щільну, структуровану інформацію з різних джерел (розмов, емейлів, зображень) і використовує її для підвищення точності, повноти та швидкості відповідей. На відміну від класичного RAG, який базується лише на семантичній схожості, Структурований RAG працює з внутрішньою структурою інформації.

**Приклад Структурованого RAG**

Замість простого відповідності ключовим словам, Структурований RAG може розпарсити деталі рейсу (пункт призначення, дата, час, авіакомпанія) з емейлу та зберегти їх у структурованому вигляді. Це дозволяє робити точні запити на кшталт «Який рейс я забронював до Парижа у вівторок?»

## Впровадження та зберігання пам’яті

Впровадження пам’яті для AI агентів передбачає систематичний процес **керування пам’яттю**, який включає генерацію, зберігання, вилучення, інтеграцію, оновлення і навіть «забування» (видалення) інформації. Особливо важливим є етап вилучення.

### Спеціалізовані інструменти пам’яті

#### Mem0

Один зі способів зберігати й управляти пам’яттю агента — це використовувати спеціалізовані інструменти, такі як Mem0. Mem0 працює як шар стійкої пам’яті, який дозволяє агентам згадувати релевантні взаємодії, зберігати вподобання користувачів і фактологічний контекст, а також вчитися на успіхах і помилках з часом. Ідея полягає в тому, що безстанні агенти стають станними.

Він працює через **двофазну пам’яттєву конвеєрну схему: вилучення та оновлення**. Спершу повідомлення, додані до нитки агента, надсилаються в сервіс Mem0, який за допомогою великої мовної моделі (LLM) підсумовує історію розмови і вилучає нові спогади. Потім фаза оновлення під керуванням LLM визначає, чи слід додати, змінити або видалити ці спогади, зберігаючи їх у гібридному сховищі даних, яке може вміщати векторні, графові та сховища ключ-значення. Ця система також підтримує різні типи пам’яті і може включати графову пам’ять для керування зв’язками між сутностями.

#### Cognee

Інший потужний підхід — використання **Cognee**, відкритої семантичної пам’яті для AI агентів, яка перетворює структуровані та неструктуровані дані в запитувані графи знань, підкріплені ембеддингами. Cognee забезпечує **архітектуру з подвійним сховищем**, що поєднує пошук за векторною схожістю з графовими відносинами, дозволяючи агентам розуміти не лише те, яка інформація схожа, а й як поняття пов’язані між собою.

Вона відзначається **гібридним вилученням**, що поєднує векторну схожість, структуру графа та LLM-розмірковування — від пошуку окремих фрагментів до питань, обізнаних про граф. Система підтримує **живу пам’ять**, яка розвивається і зростає, залишаючись запитуваною як єдиний пов’язаний граф, підтримуючи як контекст сеансів короткострокової пам’яті, так і довгострокову стійку пам’ять.

Ноутбук-інструкція Cognee ([13-agent-memory-cognee.ipynb](./13-agent-memory-cognee.ipynb)) демонструє побудову цього уніфікованого шару пам’яті з практичними прикладами завантаження різноманітних джерел даних, візуалізації графа знань і запитів із різними стратегіями пошуку, адаптованими до потреб конкретних агентів.

### Зберігання пам’яті за допомогою RAG

Окрім спеціалізованих інструментів пам’яті, таких як Mem0, ви можете використати надійні пошукові сервіси, як-от **Azure AI Search для зберігання та вилучення спогадів**, особливо для структурованого RAG.

Це дозволяє прив’язати відповіді агента до ваших власних даних, забезпечуючи більш релевантні та точні відповіді. Azure AI Search можна використовувати для зберігання користувацьких спогадів про подорожі, каталогів продуктів чи будь-яких інших специфічних знань галузі.

Azure AI Search підтримує можливості як **Структурований RAG**, який відзначається здатністю вилучати та шукати щільну, структуровану інформацію з великих наборів даних, таких як історії розмов, електронні листи чи навіть зображення. Це надає «надлюдську точність і повноту» в порівнянні з традиційними підходами розбиття тексту і ембеддингів.

## Зробити AI агентів самовдосконалюваними

Поширений підхід для агентів з самовдосконаленням полягає у введенні **«агента знань»**. Цей окремий агент спостерігає головну розмову між користувачем і основним агентом. Його роль така:

1. **Виявити цінну інформацію**: Визначити, чи є частина розмови вартою збереження як загальне знання або специфічна вподобанка користувача.

2. **Витягти та підсумувати**: Витягти основне навчання або вподобання з розмови.

3. **Зберегти у базі знань**: Постійно зберегти цю інформацію, часто у векторній базі даних, щоб її можна було пізніше вилучити.

4. **Підсилити майбутні запити**: Коли користувач починає новий запит, агент знань вилучає релевантну збережену інформацію і додає її до запиту користувача, надаючи необхідний контекст основному агенту (аналогічно до RAG).

### Оптимізації для пам’яті

• **Керування затримкою**: Щоб не уповільнювати взаємодію користувачів, спочатку можна використовувати дешевшу, швидшу модель для швидкої перевірки цінності інформації для збереження або вилучення, викликаючи більш складні процеси вилучення та оновлення лише за потреби.

• **Обслуговування бази знань**: Для зростаючої бази знань інформацію, що використовується рідше, можна переносити у «холодне сховище» для зниження витрат.

## Є ще питання щодо пам’яті агентів?

Приєднуйтеся до [Microsoft Foundry Discord](https://aka.ms/ai-agents/discord), щоб зустріти інших учнів, відвідати години офісу та отримати відповіді на ваші питання про AI агентів.

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Відмова від відповідальності**:  
Цей документ було перекладено за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ рідною мовою слід вважати авторитетним джерелом. Для критично важливої інформації рекомендується звертатися до професійного людського перекладу. Ми не несемо відповідальності за будь-які непорозуміння або неправильне тлумачення, що виникли внаслідок використання цього перекладу.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->